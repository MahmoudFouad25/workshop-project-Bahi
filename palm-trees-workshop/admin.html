<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¯ Dashboard | Ø§Ø³ØªØ¨ÙŠØ§Ù† Ø¨Ù†Ø¯ Ø§Ù„Ù†Ø®ÙŠÙ„ 2026</title>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
    <!-- SheetJS for Excel Export -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: #2ecc71;
            --primary-dark: #27ae60;
            --secondary: #3498db;
            --danger: #e74c3c;
            --warning: #f39c12;
            --success: #2ecc71;
            --dark: #2c3e50;
            --light: #ecf0f1;
            --gray: #95a5a6;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            line-height: 1.6;
        }
        
        /* ============================================ */
        /* Header */
        /* ============================================ */
        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 30px 40px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .header-left h1 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .header-left p {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .header-actions {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }
        
        .btn-white {
            background: white;
            color: var(--primary);
        }
        
        .btn-white:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .btn-outline {
            background: transparent;
            color: white;
            border: 2px solid white;
        }
        
        .btn-outline:hover {
            background: white;
            color: var(--primary);
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(46, 204, 113, 0.3);
        }
        
        .btn-secondary {
            background: var(--secondary);
            color: white;
        }
        
        .btn-secondary:hover {
            background: #2980b9;
        }
        
        .btn-danger {
            background: var(--danger);
            color: white;
        }
        
        .btn-warning {
            background: var(--warning);
            color: white;
        }
        
        /* Loading Indicator in Header */
        .loading-indicator {
            display: none;
            align-items: center;
            gap: 10px;
            background: rgba(255,255,255,0.2);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 13px;
        }
        
        .loading-indicator.active {
            display: flex;
        }
        
        .loading-spinner-small {
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255,255,255,0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* ============================================ */
        /* Main Container */
        /* ============================================ */
        .container {
            max-width: 1400px;
            margin: 40px auto;
            padding: 0 40px 40px;
        }
        
        /* ============================================ */
        /* Overview Stats Cards */
        /* ============================================ */
        .overview-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            position: relative;
            overflow: hidden;
            transition: all 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary) 0%, var(--primary-dark) 100%);
        }
        
        .stat-card.secondary::before {
            background: linear-gradient(90deg, var(--secondary) 0%, #2980b9 100%);
        }
        
        .stat-card.warning::before {
            background: linear-gradient(90deg, var(--warning) 0%, #e67e22 100%);
        }
        
        .stat-card.danger::before {
            background: linear-gradient(90deg, var(--danger) 0%, #c0392b 100%);
        }
        
        .stat-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            background: linear-gradient(135deg, rgba(46, 204, 113, 0.1) 0%, rgba(39, 174, 96, 0.1) 100%);
        }
        
        .stat-card.secondary .stat-icon {
            background: linear-gradient(135deg, rgba(52, 152, 219, 0.1) 0%, rgba(41, 128, 185, 0.1) 100%);
        }
        
        .stat-card.warning .stat-icon {
            background: linear-gradient(135deg, rgba(243, 156, 18, 0.1) 0%, rgba(230, 126, 34, 0.1) 100%);
        }
        
        .stat-card.danger .stat-icon {
            background: linear-gradient(135deg, rgba(231, 76, 60, 0.1) 0%, rgba(192, 57, 43, 0.1) 100%);
        }
        
        .stat-label {
            font-size: 14px;
            color: var(--gray);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .stat-value {
            font-size: 36px;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 8px;
            line-height: 1;
        }
        
        .stat-change {
            font-size: 13px;
            color: var(--gray);
        }
        
        .stat-change.positive {
            color: var(--success);
        }
        
        .stat-change.negative {
            color: var(--danger);
        }
        
        /* ============================================ */
        /* Section Cards */
        /* ============================================ */
        .section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--light);
        }
        
        .section-title {
            font-size: 22px;
            font-weight: 700;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .section-title-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
        }
        
        .section-subtitle {
            font-size: 14px;
            color: var(--gray);
            margin-top: 5px;
        }
        
        .section-actions {
            display: flex;
            gap: 10px;
        }
        
        /* ============================================ */
        /* Filters & Controls */
        /* ============================================ */
        .filters {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        
        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .filter-label {
            font-size: 14px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .filter-select,
        .filter-input {
            padding: 12px 16px;
            border: 2px solid var(--light);
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            transition: all 0.3s;
            background: white;
        }
        
        .filter-select:focus,
        .filter-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(46, 204, 113, 0.1);
        }
        
        /* ============================================ */
        /* Loading Overlay */
        /* ============================================ */
        .loading-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            z-index: 9999;
            justify-content: center;
            align-items: center;
        }
        
        .loading-overlay.active {
            display: flex;
        }
        
        .loading-content {
            text-align: center;
            color: white;
        }
        
        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(255,255,255,0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin: 0 auto 20px;
        }
        
        .loading-text {
            font-size: 18px;
        }
        
        /* ============================================ */
        /* Responsive */
        /* ============================================ */
        @media (max-width: 768px) {
            .header {
                padding: 20px;
            }
            
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            .header-left h1 {
                font-size: 22px;
            }
            
            .header-actions {
                width: 100%;
                justify-content: center;
                flex-wrap: wrap;
            }
            
            .container {
                padding: 20px;
            }
            
            .overview-stats {
                grid-template-columns: 1fr;
            }
            
            .section {
                padding: 20px;
            }
            
            .section-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .filters-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* ============================================ */
        /* Print Styles */
        /* ============================================ */
        @media print {
            .header-actions,
            .section-actions,
            .filters,
            .btn {
                display: none !important;
            }
            
            .section {
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loading-overlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div class="loading-text">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</div>
        </div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="header-left">
                <h1>ğŸŒ´ Dashboard | Ø§Ø³ØªØ¨ÙŠØ§Ù† Ø¨Ù†Ø¯ Ø§Ù„Ù†Ø®ÙŠÙ„ 2026</h1>
                <p>ÙˆØ±Ø´Ø© Ø§Ù„Ø¹Ù…Ù„: 20 Ù†ÙˆÙÙ…Ø¨Ø± 2025 | Ø§Ù„Ù‡Ø¯Ù: 60+ Ù…Ù„ÙŠÙˆÙ† Ø¬Ù†ÙŠÙ‡</p>
            </div>
            <div class="header-actions">
                <div class="loading-indicator" id="header-loading">
                    <div class="loading-spinner-small"></div>
                    <span>ØªØ­Ø¯ÙŠØ«...</span>
                </div>
                <button class="btn btn-white" onclick="refreshData()">
                    ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                </button>
                <button class="btn btn-outline" onclick="exportToExcel()">
                    ğŸ“Š ØªØµØ¯ÙŠØ± Excel
                </button>
                <button class="btn btn-outline" onclick="window.print()">
                    ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©
                </button>
                <a href="survey.html" class="btn btn-white" target="_blank">
                    ğŸ‘ï¸ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø§Ø³ØªØ¨ÙŠØ§Ù†
                </a>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="container">
        
        <!-- Overview Statistics -->
        <div class="overview-stats" id="overview-stats">
            <div class="stat-card">
                <div class="stat-header">
                    <div class="stat-icon">ğŸ‘¥</div>
                </div>
                <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ†</div>
                <div class="stat-value" id="total-responses">-</div>
                <div class="stat-change">Ù…Ù† Ø£ØµÙ„ 150 Ù…ÙˆØ¸Ù Ù…Ø³ØªÙ‡Ø¯Ù</div>
            </div>
            
            <div class="stat-card secondary">
                <div class="stat-header">
                    <div class="stat-icon">âœ…</div>
                </div>
                <div class="stat-label">Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥ÙƒÙ…Ø§Ù„</div>
                <div class="stat-value" id="completion-rate">-</div>
                <div class="stat-change" id="completion-change">Ø­Ø³Ø§Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠ</div>
            </div>
            
            <div class="stat-card warning">
                <div class="stat-header">
                    <div class="stat-icon">â±ï¸</div>
                </div>
                <div class="stat-label">Ù…ØªÙˆØ³Ø· Ø§Ù„ÙˆÙ‚Øª</div>
                <div class="stat-value" id="avg-time">-</div>
                <div class="stat-change">Ù…Ù† 15-18 Ø¯Ù‚ÙŠÙ‚Ø© Ù…ØªÙˆÙ‚Ø¹Ø©</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-header">
                    <div class="stat-icon">â­</div>
                </div>
                <div class="stat-label">Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ© Ù„Ù„Ù‡Ø¯Ù</div>
                <div class="stat-value" id="readiness-avg">-</div>
                <div class="stat-change">Ù…Ù† 10 (Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„Ø´Ø®ØµÙŠØ©)</div>
            </div>
        </div>
        <!-- Filters Section -->
        <div class="filters">
            <div class="filters-grid">
                <div class="filter-group">
                    <label class="filter-label">ğŸ¢ ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„Ù‚Ø³Ù…:</label>
                    <select class="filter-select" id="filter-department" onchange="applyFilters()">
                        <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</option>
                        <option value="Ø§Ù„ÙƒÙˆÙ„ Ø³Ù†ØªØ± Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ">Ø§Ù„ÙƒÙˆÙ„ Ø³Ù†ØªØ± Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ</option>
                        <option value="Ø§Ù„ÙƒÙˆÙ„ Ø³Ù†ØªØ± Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ">Ø§Ù„ÙƒÙˆÙ„ Ø³Ù†ØªØ± Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ</option>
                        <option value="Ù…Ù†Ø§ÙØ° Ø§Ù„ØªÙ…ÙˆÙŠÙ„">Ù…Ù†Ø§ÙØ° Ø§Ù„ØªÙ…ÙˆÙŠÙ„ (Booths)</option>
                        <option value="Ø§Ù„Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†">Ø§Ù„Ø£ÙˆÙ†Ù„Ø§ÙŠÙ† (Online/Digital)</option>
                        <option value="Ø§Ù„Ù†ØªÙˆØ±Ùƒ">Ø§Ù„Ù†ØªÙˆØ±Ùƒ (Network)</option>
                        <option value="Ø§Ù„ØªØ­ØµÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±">Ø§Ù„ØªØ­ØµÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±</option>
                        <option value="Ø­Ù…Ù„Ø§Øª Ø§Ù„Ù…ØªØ·ÙˆØ¹ÙŠÙ†">Ø­Ù…Ù„Ø§Øª Ø§Ù„Ù…ØªØ·ÙˆØ¹ÙŠÙ†</option>
                        <option value="Ø§Ù„ØªØ¨Ø±Ø¹Ø§Øª Ø§Ù„Ø¹ÙŠÙ†ÙŠØ©">Ø§Ù„ØªØ¨Ø±Ø¹Ø§Øª Ø§Ù„Ø¹ÙŠÙ†ÙŠØ©</option>
                        <option value="Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø¯Ø§Ø¹Ù…Ø©">Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø¯Ø§Ø¹Ù…Ø©</option>
                        <option value="Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ/Ø§Ù„Ù‚ÙŠØ§Ø¯ÙŠ">Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ/Ø§Ù„Ù‚ÙŠØ§Ø¯ÙŠ</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label class="filter-label">ğŸ“… ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø³Ù†ÙˆØ§Øª Ø§Ù„Ø®Ø¨Ø±Ø©:</label>
                    <select class="filter-select" id="filter-experience" onchange="applyFilters()">
                        <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª</option>
                        <option value="Ø£Ù‚Ù„ Ù…Ù† 6 Ø´Ù‡ÙˆØ±">Ø£Ù‚Ù„ Ù…Ù† 6 Ø´Ù‡ÙˆØ±</option>
                        <option value="6 Ø´Ù‡ÙˆØ± - Ø³Ù†Ø©">6 Ø´Ù‡ÙˆØ± - Ø³Ù†Ø©</option>
                        <option value="1-3 Ø³Ù†ÙˆØ§Øª">1-3 Ø³Ù†ÙˆØ§Øª</option>
                        <option value="3-5 Ø³Ù†ÙˆØ§Øª">3-5 Ø³Ù†ÙˆØ§Øª</option>
                        <option value="Ø£ÙƒØ«Ø± Ù…Ù† 5 Ø³Ù†ÙˆØ§Øª">Ø£ÙƒØ«Ø± Ù…Ù† 5 Ø³Ù†ÙˆØ§Øª</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label class="filter-label">ğŸ¯ ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ©:</label>
                    <select class="filter-select" id="filter-readiness" onchange="applyFilters()">
                        <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª</option>
                        <option value="high">Ø¹Ø§Ù„ÙŠØ© (8-10)</option>
                        <option value="medium">Ù…ØªÙˆØ³Ø·Ø© (5-7)</option>
                        <option value="low">Ù…Ù†Ø®ÙØ¶Ø© (1-4)</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label class="filter-label">ğŸ” Ø¨Ø­Ø«:</label>
                    <input type="text" class="filter-input" id="filter-search" placeholder="Ø§Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª..." oninput="applyFilters()">
                </div>
            </div>
        </div>

        <!-- ============================================ -->
        <!-- Section 1: Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¯ÙŠÙ…ÙˆØºØ±Ø§ÙÙŠ -->
        <!-- ============================================ -->
        <div class="section">
            <div class="section-header">
                <div>
                    <div class="section-title">
                        <span class="section-title-icon">ğŸ“Š</span>
                        Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¯ÙŠÙ…ÙˆØºØ±Ø§ÙÙŠ Ù„Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ†
                    </div>
                    <div class="section-subtitle">Ù…Ù† Ù‡Ù… Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙˆÙ† ÙÙŠ Ø§Ù„Ø§Ø³ØªØ¨ÙŠØ§Ù†ØŸ</div>
                </div>
                <div class="section-actions">
                    <button class="btn btn-secondary" onclick="exportSectionData('demographics')">
                        ğŸ“¥ ØªØµØ¯ÙŠØ± Ø§Ù„Ù‚Ø³Ù…
                    </button>
                </div>
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(450px, 1fr)); gap: 30px;">
                <!-- Chart: Distribution by Department -->
                <div>
                    <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                        ğŸ¢ Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø­Ø³Ø¨ Ø§Ù„Ù‚Ø³Ù…/Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
                    </h3>
                    <canvas id="chart-departments" style="max-height: 300px;"></canvas>
                </div>
                
                <!-- Chart: Distribution by Experience -->
                <div>
                    <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                        ğŸ“… Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø­Ø³Ø¨ Ø³Ù†ÙˆØ§Øª Ø§Ù„Ø®Ø¨Ø±Ø©
                    </h3>
                    <canvas id="chart-experience" style="max-height: 300px;"></canvas>
                </div>
                
                <!-- Chart: Worked on Palm 2025 -->
                <div>
                    <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                        ğŸŒ´ Ù‡Ù„ Ø¹Ù…Ù„ Ø¹Ù„Ù‰ Ø¨Ù†Ø¯ Ø§Ù„Ù†Ø®ÙŠÙ„ ÙÙŠ 2025ØŸ
                    </h3>
                    <canvas id="chart-worked-palm" style="max-height: 300px;"></canvas>
                </div>
                
                <!-- Chart: Number of Items -->
                <div>
                    <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                        ğŸ¯ Ø¹Ø¯Ø¯ Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø§Ù„ØªÙŠ ÙŠØ¹Ù…Ù„ Ø¹Ù„ÙŠÙ‡Ø§
                    </h3>
                    <canvas id="chart-items-count" style="max-height: 300px;"></canvas>
                </div>
            </div>
            
            <!-- Knowledge Rating Distribution -->
            <div style="margin-top: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ“ˆ ØªÙˆØ²ÙŠØ¹ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ø¹Ø±ÙØ© Ø¨Ø¨Ù†Ø¯ Ø§Ù„Ù†Ø®ÙŠÙ„ (1-10)
                </h3>
                <canvas id="chart-knowledge-rating" style="max-height: 250px;"></canvas>
                <div style="margin-top: 15px; padding: 15px; background: #f8f9fa; border-radius: 10px; border-right: 4px solid var(--primary);">
                    <strong>ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø¹Ø±ÙØ©:</strong><br>
                    <span id="knowledge-stats">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨...</span>
                </div>
            </div>
        </div>

        <!-- ============================================ -->
        <!-- Section 2: Ø§Ù„ÙÙ‡Ù… ÙˆØ§Ù„Ù…Ø¹Ø±ÙØ© -->
        <!-- ============================================ -->
        <div class="section">
            <div class="section-header">
                <div>
                    <div class="section-title">
                        <span class="section-title-icon">ğŸ“–</span>
                        Ø§Ù„ÙÙ‡Ù… ÙˆØ§Ù„Ù…Ø¹Ø±ÙØ© Ø¨Ø¨Ù†Ø¯ Ø§Ù„Ù†Ø®ÙŠÙ„
                    </div>
                    <div class="section-subtitle">Ù…Ø§ Ù…Ø¯Ù‰ ÙÙ‡Ù… Ø§Ù„ÙØ±ÙŠÙ‚ Ù„Ù„Ø¨Ù†Ø¯ØŸ</div>
                </div>
                <div class="section-actions">
                    <button class="btn btn-secondary" onclick="exportSectionData('understanding')">
                        ğŸ“¥ ØªØµØ¯ÙŠØ± Ø§Ù„Ù‚Ø³Ù…
                    </button>
                </div>
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(450px, 1fr)); gap: 30px;">
                <!-- Understanding Level -->
                <div>
                    <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                        ğŸ¯ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ÙÙ‡Ù… Ù„Ù‚ØµØ© Ø¨Ù†Ø¯ Ø§Ù„Ù†Ø®ÙŠÙ„
                    </h3>
                    <canvas id="chart-understanding" style="max-height: 300px;"></canvas>
                </div>
                
                <!-- Info Sufficient -->
                <div>
                    <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                        ğŸ“‹ ÙƒÙØ§ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©
                    </h3>
                    <canvas id="chart-info-sufficient" style="max-height: 300px;"></canvas>
                </div>
            </div>
            
            <!-- Missing Information -->
            <div style="margin-top: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    âš ï¸ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø§Ù‚ØµØ© Ø§Ù„Ø£ÙƒØ«Ø± Ø·Ù„Ø¨Ø§Ù‹
                </h3>
                <canvas id="chart-missing-info" style="max-height: 300px;"></canvas>
            </div>
            
            <!-- Explanation Difficulty -->
            <div style="margin-top: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ’¬ ØµØ¹ÙˆØ¨Ø© Ø´Ø±Ø­ Ø§Ù„Ø¨Ù†Ø¯ Ù„Ù„Ù…ØªØ¨Ø±Ø¹ÙŠÙ†
                </h3>
                <canvas id="chart-explanation-difficulty" style="max-height: 250px;"></canvas>
            </div>
            
            <!-- Hardest Questions from Donors -->
            <div style="margin-top: 30px; padding: 20px; background: #fff3cd; border-radius: 10px; border-right: 4px solid var(--warning);">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ”¥ Ø£ØµØ¹Ø¨ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ù…Ù† Ø§Ù„Ù…ØªØ¨Ø±Ø¹ÙŠÙ† (Ù†ØµÙˆØµ Ù…ÙØªÙˆØ­Ø©)
                </h3>
                <div id="hardest-questions-list" style="max-height: 400px; overflow-y: auto;">
                    Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...
                </div>
            </div>
            
            <!-- Palm Difficulty Factors -->
            <div style="margin-top: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸš§ Ù…Ø§ ÙŠØ¬Ø¹Ù„ Ø¨Ù†Ø¯ Ø§Ù„Ù†Ø®ÙŠÙ„ Ø£ØµØ¹Ø¨ Ù…Ù† Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø§Ù„Ø£Ø®Ø±Ù‰
                </h3>
                <canvas id="chart-palm-difficulty" style="max-height: 300px;"></canvas>
            </div>
            
            <!-- Easiest Item Comparison -->
            <div style="margin-top: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    âœ… Ø£Ø³Ù‡Ù„ Ø¨Ù†Ø¯ ÙÙŠ Ø§Ù„ØªØ³ÙˆÙŠÙ‚ ÙˆØ§Ù„Ø¥Ù‚Ù†Ø§Ø¹ (Ù…Ù‚Ø§Ø±Ù†Ø©)
                </h3>
                <canvas id="chart-easiest-item" style="max-height: 300px;"></canvas>
            </div>
        </div>

        <!-- ============================================ -->
        <!-- Section 3: ØªØ­Ù„ÙŠÙ„ Ø£Ø¯Ø§Ø¡ 2025 -->
        <!-- ============================================ -->
        <div class="section">
            <div class="section-header">
                <div>
                    <div class="section-title">
                        <span class="section-title-icon">ğŸ”</span>
                        ØªØ­Ù„ÙŠÙ„ Ø£Ø¯Ø§Ø¡ 2025 - Ù„Ù…Ø§Ø°Ø§ Ù„Ù… Ù†Ø­Ù‚Ù‚ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØŸ
                    </div>
                    <div class="section-subtitle">ØªØ­Ù„ÙŠÙ„ Ø¹Ù…ÙŠÙ‚ Ù„Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø³Ø§Ø¨Ù‚</div>
                </div>
                <div class="section-actions">
                    <button class="btn btn-secondary" onclick="exportSectionData('performance-2025')">
                        ğŸ“¥ ØªØµØ¯ÙŠØ± Ø§Ù„Ù‚Ø³Ù…
                    </button>
                </div>
            </div>
            
            <!-- Know Target -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ¯ Ù‡Ù„ ÙŠØ¹Ø±Ù Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù Ø§Ù„Ù…Ø§Ù„ÙŠ Ù„Ù€2025ØŸ
                </h3>
                <canvas id="chart-know-target" style="max-height: 250px;"></canvas>
            </div>
            
            <!-- Failure Reasons -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    âŒ Ø£Ø³Ø¨Ø§Ø¨ Ø¹Ø¯Ù… ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù ÙÙŠ 2025 (Ø£Ù‡Ù… 3 Ø£Ø³Ø¨Ø§Ø¨)
                </h3>
                <canvas id="chart-failure-reasons" style="max-height: 350px;"></canvas>
                <div style="margin-top: 15px; padding: 15px; background: #f8d7da; border-radius: 10px; border-right: 4px solid var(--danger);">
                    <strong>ğŸš¨ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø­Ø±Ø¬:</strong><br>
                    <span id="critical-analysis">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„...</span>
                </div>
            </div>
            
            <!-- Performance by Quarter -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px;">
                <div>
                    <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                        ğŸ“ˆ Ø£Ù‚ÙˆÙ‰ ÙØªØ±Ø© ÙÙŠ 2025
                    </h3>
                    <canvas id="chart-strong-period" style="max-height: 300px;"></canvas>
                </div>
                
                <div>
                    <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                        ğŸ“‰ Ø£Ø¶Ø¹Ù ÙØªØ±Ø© ÙÙŠ 2025
                    </h3>
                    <canvas id="chart-weak-period" style="max-height: 300px;"></canvas>
                </div>
            </div>
            
            <!-- Period Reasons (Text) -->
            <div style="margin-bottom: 30px; padding: 20px; background: #e7f3ff; border-radius: 10px; border-right: 4px solid var(--secondary);">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ’¡ Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ù‚ÙˆØ© ÙˆØ§Ù„Ø¶Ø¹Ù ÙÙŠ Ø§Ù„ÙØªØ±Ø§Øª (Ù†ØµÙˆØµ Ù…ÙØªÙˆØ­Ø©)
                </h3>
                <div id="period-reasons-text" style="max-height: 300px; overflow-y: auto;">
                    Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...
                </div>
            </div>
            
            <!-- Documentation Impact -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ“„ ØªØ£Ø«ÙŠØ± ØªÙ‚Ù„ÙŠØµ Ù…Ø¯Ø© Ø§Ù„ØªÙˆØ«ÙŠÙ‚ (40 â†’ 15 ÙŠÙˆÙ…)
                </h3>
                <canvas id="chart-doc-impact" style="max-height: 250px;"></canvas>
            </div>
            
            <!-- Umrah Draw Impact -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ•‹ ØªØ£Ø«ÙŠØ± Ø³Ø­Ø¨ Ø§Ù„Ø¹Ù…Ø±Ø© Ø¹Ù„Ù‰ Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØªØ¨Ø±Ø¹ÙŠÙ†
                </h3>
                <canvas id="chart-umrah-impact" style="max-height: 250px;"></canvas>
            </div>
            
            <!-- Hardest Stage -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸª Ø£ØµØ¹Ø¨ Ù…Ø±Ø­Ù„Ø© ÙÙŠ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ù…ØªØ¨Ø±Ø¹ÙŠ Ø§Ù„Ù†Ø®ÙŠÙ„
                </h3>
                <canvas id="chart-hardest-stage" style="max-height: 300px;"></canvas>
            </div>
            
            <!-- Real Situations 2025 -->
            <div style="padding: 20px; background: #fff3cd; border-radius: 10px; border-right: 4px solid var(--warning);">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ“ Ù…ÙˆØ§Ù‚Ù Ø­Ù‚ÙŠÙ‚ÙŠØ© ØªÙˆØ¶Ø­ Ø³Ø¨Ø¨ Ø¶Ø¹Ù Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ÙÙŠ 2025
                </h3>
                <div id="situations-2025-list" style="max-height: 400px; overflow-y: auto;">
                    Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...
                </div>
            </div>
            
            <!-- Would Change (If went back to 2025) -->
            <div style="margin-top: 30px; padding: 20px; background: #d4edda; border-radius: 10px; border-right: 4px solid var(--success);">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ”„ Ù„Ùˆ Ø±Ø¬Ø¹ Ø§Ù„Ø²Ù…Ù† Ù„Ø¨Ø¯Ø§ÙŠØ© 2025... Ø£ÙˆÙ„ Ø­Ø§Ø¬Ø© Ø³ÙŠØºÙŠØ±ÙˆÙ†Ù‡Ø§
                </h3>
                <div id="would-change-list" style="max-height: 400px; overflow-y: auto;">
                    Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...
                </div>
            </div>
        </div>

        <!-- ============================================ -->
        <!-- Section 4: Ø§Ù„Ù…Ù†Ø§ÙØ³Ø© -->
        <!-- ============================================ -->
        <div class="section">
            <div class="section-header">
                <div>
                    <div class="section-title">
                        <span class="section-title-icon">ğŸ†</span>
                        Ø§Ù„Ù…Ù†Ø§ÙØ³Ø© - Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ© ÙˆØ§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©
                    </div>
                    <div class="section-subtitle">ÙƒÙŠÙ Ù†ØªÙ…ÙŠØ² ÙˆÙ†ØªÙÙˆÙ‚ØŸ</div>
                </div>
                <div class="section-actions">
                    <button class="btn btn-secondary" onclick="exportSectionData('competition')">
                        ğŸ“¥ ØªØµØ¯ÙŠØ± Ø§Ù„Ù‚Ø³Ù…
                    </button>
                </div>
            </div>
            
            <!-- Know Competitors -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ‘ï¸ Ù…Ø¹Ø±ÙØ© Ø§Ù„ÙØ±ÙŠÙ‚ Ø¨Ø§Ù„Ù…Ù†Ø§ÙØ³ÙŠÙ†
                </h3>
                <canvas id="chart-know-competitors" style="max-height: 250px;"></canvas>
            </div>
            
            <!-- Competitor Names -->
            <div style="margin-bottom: 30px; padding: 20px; background: #f8f9fa; border-radius: 10px; border-right: 4px solid var(--gray);">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ¢ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…Ø¤Ø³Ø³Ø§Øª Ø§Ù„Ù…Ù†Ø§ÙØ³Ø© Ø§Ù„Ù…Ø°ÙƒÙˆØ±Ø©
                </h3>
                <div id="competitor-names-list">
                    Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...
                </div>
            </div>
            
            <!-- Our Advantages -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    â­ Ù…Ø§ ÙŠÙ…ÙŠØ² "Ù†Ø®ÙŠÙ„ ØµÙ†Ø§Ø¹ Ø§Ù„Ø­ÙŠØ§Ø©" Ø¹Ù† Ø§Ù„Ù…Ù†Ø§ÙØ³ÙŠÙ†
                </h3>
                <canvas id="chart-our-advantages" style="max-height: 350px;"></canvas>
            </div>
            
            <!-- Competitor Objections -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ’¬ ØªÙƒØ±Ø§Ø± Ø§Ø¹ØªØ±Ø§Ø¶Ø§Øª Ø§Ù„Ù…ØªØ¨Ø±Ø¹ÙŠÙ† Ø¨Ø³Ø¨Ø¨ Ø§Ù„Ù…Ù†Ø§ÙØ³ÙŠÙ†
                </h3>
                <canvas id="chart-competitor-objections" style="max-height: 250px;"></canvas>
            </div>
            
            <!-- Common Objections Text -->
            <div style="margin-bottom: 30px; padding: 20px; background: #fff3cd; border-radius: 10px; border-right: 4px solid var(--warning);">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ—£ï¸ Ø£ÙƒØ«Ø± Ø§Ù„Ø§Ø¹ØªØ±Ø§Ø¶Ø§Øª ØªÙƒØ±Ø§Ø±Ø§Ù‹ Ù…Ù† Ø§Ù„Ù…ØªØ¨Ø±Ø¹ÙŠÙ†
                </h3>
                <div id="common-objections-list" style="max-height: 300px; overflow-y: auto;">
                    Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...
                </div>
            </div>
            
            <!-- Internal Competition -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ”„ Ø§Ù„Ù…Ù†Ø§ÙØ³Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ© - Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø§Ù„ØªÙŠ ØªØ£ÙƒÙ„ Ù…Ù† Ø­ØµØ© Ø§Ù„Ù†Ø®ÙŠÙ„
                </h3>
                <canvas id="chart-internal-competition" style="max-height: 300px;"></canvas>
            </div>
            
            <!-- Items Conflict -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ˜µ ØªØ¶Ø§Ø±Ø¨/ØªØ´ØªØª Ø¹Ù†Ø¯ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø¨Ù†ÙˆØ¯ Ù…ØªØ¹Ø¯Ø¯Ø©
                </h3>
                <canvas id="chart-items-conflict" style="max-height: 250px;"></canvas>
            </div>
            
            <!-- Multi-Item Solution -->
            <div>
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ’¡ Ø­Ù„ÙˆÙ„ Ù…Ù‚ØªØ±Ø­Ø© Ù„ØªØ³ÙˆÙŠÙ‚ Ø§Ù„Ù†Ø®ÙŠÙ„ Ø¨Ø¬Ø§Ù†Ø¨ Ø¨Ù†ÙˆØ¯ Ø£Ø®Ø±Ù‰
                </h3>
                <canvas id="chart-multi-item-solution" style="max-height: 300px;"></canvas>
            </div>
        </div>

        <!-- ============================================ -->
        <!-- Section 5: Ø§Ù„ØªØ³ÙˆÙŠÙ‚ ÙˆØ§Ù„Ù…Ø­ØªÙˆÙ‰ -->
        <!-- ============================================ -->
        <div class="section">
            <div class="section-header">
                <div>
                    <div class="section-title">
                        <span class="section-title-icon">ğŸ“¢</span>
                        Ø§Ù„ØªØ³ÙˆÙŠÙ‚ ÙˆØ§Ù„Ù…Ø­ØªÙˆÙ‰ ÙˆØ§Ù„Ø±Ø³Ø§Ø¦Ù„
                    </div>
                    <div class="section-subtitle">Ù…Ø§ Ù…Ø¯Ù‰ ÙØ¹Ø§Ù„ÙŠØ© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ³ÙˆÙŠÙ‚ÙŠØŸ</div>
                </div>
                <div class="section-actions">
                    <button class="btn btn-secondary" onclick="exportSectionData('marketing')">
                        ğŸ“¥ ØªØµØ¯ÙŠØ± Ø§Ù„Ù‚Ø³Ù…
                    </button>
                </div>
            </div>
            
            <!-- Content Quality Rating -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    â­ ØªÙ‚ÙŠÙŠÙ… Ø¬ÙˆØ¯Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ³ÙˆÙŠÙ‚ÙŠ (1-10)
                </h3>
                <canvas id="chart-content-quality" style="max-height: 250px;"></canvas>
                <div style="margin-top: 15px; padding: 15px; background: #f8f9fa; border-radius: 10px; border-right: 4px solid var(--secondary);">
                    <strong>ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø­ØªÙˆÙ‰:</strong><br>
                    <span id="content-quality-stats">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨...</span>
                </div>
            </div>
            
            <!-- Most Effective Content -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ¯ Ø£ÙƒØ«Ø± Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ØªØ£Ø«ÙŠØ±Ø§Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù…ØªØ¨Ø±Ø¹ÙŠÙ†
                </h3>
                <canvas id="chart-effective-content" style="max-height: 300px;"></canvas>
            </div>
            
            <!-- Messages Clarity -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ’¬ ÙˆØ¶ÙˆØ­ ÙˆØ¥Ù‚Ù†Ø§Ø¹ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªØ³ÙˆÙŠÙ‚ÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
                </h3>
                <canvas id="chart-messages-clarity" style="max-height: 250px;"></canvas>
            </div>
            
            <!-- Best Message -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ† Ø£Ù‚ÙˆÙ‰ Ø±Ø³Ø§Ù„Ø© ØªØ³ÙˆÙŠÙ‚ÙŠØ© Ù„Ø¨Ù†Ø¯ Ø§Ù„Ù†Ø®ÙŠÙ„
                </h3>
                <canvas id="chart-best-message" style="max-height: 350px;"></canvas>
            </div>
            
            <!-- Main Objections -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    âš ï¸ Ø£ÙƒØ«Ø± Ø§Ø¹ØªØ±Ø§Ø¶ Ù…Ù† Ø§Ù„Ù…ØªØ¨Ø±Ø¹ÙŠÙ† Ø¹Ù†Ø¯ Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ù†Ø¯
                </h3>
                <canvas id="chart-main-objection" style="max-height: 300px;"></canvas>
            </div>
            
            <!-- Ready Answers -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    âœ… Ø¬Ø§Ù‡Ø²ÙŠØ© Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ÙØ±ÙŠÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø¹ØªØ±Ø§Ø¶Ø§Øª
                </h3>
                <canvas id="chart-ready-answers" style="max-height: 250px;"></canvas>
            </div>
            
            <!-- Ad Channels Priority -->
            <div>
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ“± Ø£ÙˆÙ„ÙˆÙŠØ© Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ÙŠØ© (Ù„Ùˆ ÙƒØ§Ù†Øª Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ù…Ø­Ø¯ÙˆØ¯Ø©)
                </h3>
                <canvas id="chart-ad-channels" style="max-height: 350px;"></canvas>
            </div>
        </div>
        <!-- ============================================ -->
        <!-- Section 6: Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ù…Ø¹ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ -->
        <!-- ============================================ -->
        <div class="section">
            <div class="section-header">
                <div>
                    <div class="section-title">
                        <span class="section-title-icon">ğŸ¤</span>
                        Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ù…Ø¹ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹/Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬
                    </div>
                    <div class="section-subtitle">Ù…Ø¯Ù‰ Ø§Ù„ØªØ¹Ø§ÙˆÙ† ÙˆØ§Ù„ØªÙ†Ø³ÙŠÙ‚ Ø¨ÙŠÙ† Ø§Ù„Ø¥Ø¯Ø§Ø±Ø§Øª</div>
                </div>
                <div class="section-actions">
                    <button class="btn btn-secondary" onclick="exportSectionData('coordination')">
                        ğŸ“¥ ØªØµØ¯ÙŠØ± Ø§Ù„Ù‚Ø³Ù…
                    </button>
                </div>
            </div>
            
            <!-- Coordination Quality Rating -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    â­ ØªÙ‚ÙŠÙŠÙ… Ø¬ÙˆØ¯Ø© Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ (1-10)
                </h3>
                <canvas id="chart-coordination-quality" style="max-height: 250px;"></canvas>
                <div style="margin-top: 15px; padding: 15px; background: #f8f9fa; border-radius: 10px; border-right: 4px solid var(--secondary);">
                    <strong>ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªÙ†Ø³ÙŠÙ‚:</strong><br>
                    <span id="coordination-stats">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨...</span>
                </div>
            </div>
            
            <!-- Coordination Problems -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸš§ Ø£ÙƒØ«Ø± Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ÙŠØ© Ø¨ÙŠÙ† Ø§Ù„ØªÙ…ÙˆÙŠÙ„ ÙˆØ§Ù„Ø¨Ø±Ø§Ù…Ø¬
                </h3>
                <canvas id="chart-coordination-problems" style="max-height: 350px;"></canvas>
            </div>
            
            <!-- SLA Existence -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ“‹ ÙˆØ¬ÙˆØ¯ Ø§ØªÙØ§Ù‚ÙŠØ© ÙˆØ§Ø¶Ø­Ø© (SLA) Ø¨ÙŠÙ† Ø§Ù„ØªÙ…ÙˆÙŠÙ„ ÙˆØ§Ù„Ø¨Ø±Ø§Ù…Ø¬
                </h3>
                <canvas id="chart-sla-existence" style="max-height: 250px;"></canvas>
            </div>
            
            <!-- Problem Resolution -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    âš™ï¸ Ù…Ø§Ø°Ø§ ÙŠØ­Ø¯Ø« Ø¹Ù†Ø¯ ÙˆØ¬ÙˆØ¯ Ù…Ø´ÙƒÙ„Ø© Ù…Ù† Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬ØŸ
                </h3>
                <canvas id="chart-problem-resolution" style="max-height: 300px;"></canvas>
            </div>
            
            <!-- Needs from Programs -->
            <div>
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ“ Ù…Ø§ ÙŠØ­ØªØ§Ø¬Ù‡ Ø§Ù„ÙØ±ÙŠÙ‚ Ù…Ù† Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹/Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬
                </h3>
                <canvas id="chart-needs-from-programs" style="max-height: 350px;"></canvas>
            </div>
        </div>

        <!-- ============================================ -->
        <!-- Section 7: Ø§Ù„Ù…ÙˆØ³Ù…ÙŠØ© ÙˆØ§Ù„ØªÙˆÙ‚ÙŠØª -->
        <!-- ============================================ -->
        <div class="section">
            <div class="section-header">
                <div>
                    <div class="section-title">
                        <span class="section-title-icon">â°</span>
                        Ø§Ù„Ù…ÙˆØ³Ù…ÙŠØ© ÙˆØ§Ù„ØªÙˆÙ‚ÙŠØª Ø§Ù„Ø£Ù…Ø«Ù„
                    </div>
                    <div class="section-subtitle">Ù…ØªÙ‰ Ù†Ø±ÙƒØ² Ø¹Ù„Ù‰ Ø¨Ù†Ø¯ Ø§Ù„Ù†Ø®ÙŠÙ„ØŸ</div>
                </div>
                <div class="section-actions">
                    <button class="btn btn-secondary" onclick="exportSectionData('timing')">
                        ğŸ“¥ ØªØµØ¯ÙŠØ± Ø§Ù„Ù‚Ø³Ù…
                    </button>
                </div>
            </div>
            
            <!-- Best Timing -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ“… Ø£ÙØ¶Ù„ ÙˆÙ‚Øª Ù„Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø¨Ù†Ø¯ Ø§Ù„Ù†Ø®ÙŠÙ„
                </h3>
                <canvas id="chart-best-timing" style="max-height: 300px;"></canvas>
            </div>
            
            <!-- Seasonal Approach -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ”„ Ù‡Ù„ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ù†Ø®ÙŠÙ„ Ù…ÙˆØ³Ù…ÙŠ Ø£Ù… Ù…Ø³ØªÙ…Ø±ØŸ
                </h3>
                <canvas id="chart-seasonal-approach" style="max-height: 250px;"></canvas>
            </div>
            
            <!-- Campaigns Effect -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ“Š ØªØ£Ø«ÙŠØ± Ø§Ù„Ø­Ù…Ù„Ø§Øª Ø§Ù„Ù…ÙˆØ³Ù…ÙŠØ© (Ø±Ù…Ø¶Ø§Ù†ØŒ Ø£Ø¶Ø§Ø­ÙŠ) Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø®ÙŠÙ„
                </h3>
                <canvas id="chart-campaigns-effect" style="max-height: 250px;"></canvas>
            </div>
            
            <!-- Quarterly Distribution -->
            <div>
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ“ˆ ØªÙˆØ²ÙŠØ¹ Ø§Ù„ØªØ±ÙƒÙŠØ² Ø§Ù„Ù…Ù‚ØªØ±Ø­ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø®ÙŠÙ„ Ø®Ù„Ø§Ù„ 2026 (%)
                </h3>
                <canvas id="chart-quarterly-distribution" style="max-height: 300px;"></canvas>
                <div style="margin-top: 15px; padding: 15px; background: #e7f3ff; border-radius: 10px; border-right: 4px solid var(--secondary);">
                    <strong>ğŸ’¡ Ø§Ù„ØªØ­Ù„ÙŠÙ„:</strong><br>
                    <span id="quarterly-analysis">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„...</span>
                </div>
            </div>
        </div>

        <!-- ============================================ -->
        <!-- Section 8: Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ© Ù„Ù€60 Ù…Ù„ÙŠÙˆÙ† -->
        <!-- ============================================ -->
        <div class="section">
            <div class="section-header">
                <div>
                    <div class="section-title">
                        <span class="section-title-icon">ğŸ’ª</span>
                        Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ© Ù„ØªØ­Ù‚ÙŠÙ‚ 60 Ù…Ù„ÙŠÙˆÙ† ÙÙŠ 2026
                    </div>
                    <div class="section-subtitle">Ù‡Ù„ Ù†Ø­Ù† Ù…Ø³ØªØ¹Ø¯ÙˆÙ† ÙØ¹Ù„Ø§Ù‹ØŸ</div>
                </div>
                <div class="section-actions">
                    <button class="btn btn-secondary" onclick="exportSectionData('readiness')">
                        ğŸ“¥ ØªØµØ¯ÙŠØ± Ø§Ù„Ù‚Ø³Ù…
                    </button>
                </div>
            </div>
            
            <!-- Readiness Comparison -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ“Š Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„Ø´Ø®ØµÙŠØ© vs Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„ÙØ±ÙŠÙ‚ (1-10)
                </h3>
                <canvas id="chart-readiness-comparison" style="max-height: 300px;"></canvas>
                <div style="margin-top: 15px; padding: 15px; background: #f8f9fa; border-radius: 10px; border-right: 4px solid var(--primary);">
                    <strong>ğŸ“ˆ ÙØ¬ÙˆØ© Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ©:</strong><br>
                    <span id="readiness-gap-analysis">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨...</span>
                </div>
            </div>
            
            <!-- Personal Readiness Distribution -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px;">
                <div>
                    <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                        ğŸ‘¤ ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„Ø´Ø®ØµÙŠØ©
                    </h3>
                    <canvas id="chart-personal-readiness" style="max-height: 250px;"></canvas>
                </div>
                
                <div>
                    <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                        ğŸ‘¥ ØªÙˆØ²ÙŠØ¹ Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„ÙØ±ÙŠÙ‚
                    </h3>
                    <canvas id="chart-team-readiness" style="max-height: 250px;"></canvas>
                </div>
            </div>
            
            <!-- Target Possible -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ¯ Ù‡Ù„ ØªØ­Ù‚ÙŠÙ‚ 60 Ù…Ù„ÙŠÙˆÙ† Ù…Ù…ÙƒÙ†ØŸ
                </h3>
                <canvas id="chart-target-possible" style="max-height: 300px;"></canvas>
            </div>
            
            <!-- Success Requirements -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    âœ… Ø£Ù‡Ù… 3 Ø£Ø´ÙŠØ§Ø¡ ÙŠØ¬Ø¨ ØªÙˆÙÙŠØ±Ù‡Ø§ Ù„ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù
                </h3>
                <canvas id="chart-success-requirements" style="max-height: 350px;"></canvas>
            </div>
            
            <!-- Should Stop/Start -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                <div style="padding: 20px; background: #f8d7da; border-radius: 10px; border-right: 4px solid var(--danger);">
                    <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                        âŒ Ù…Ø§ ÙŠØ¬Ø¨ Ø§Ù„ØªÙˆÙ‚Ù Ø¹Ù†Ù‡ ÙÙˆØ±Ø§Ù‹
                    </h3>
                    <div id="should-stop-list" style="max-height: 350px; overflow-y: auto;">
                        Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...
                    </div>
                </div>
                
                <div style="padding: 20px; background: #d4edda; border-radius: 10px; border-right: 4px solid var(--success);">
                    <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                        âœ… Ù…Ø§ ÙŠØ¬Ø¨ Ø§Ù„Ø¨Ø¯Ø¡ ÙÙŠÙ‡ ÙÙˆØ±Ø§Ù‹
                    </h3>
                    <div id="should-start-list" style="max-height: 350px; overflow-y: auto;">
                        Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...
                    </div>
                </div>
            </div>
        </div>

        <!-- ============================================ -->
        <!-- Section 9: Ù„Ùˆ ÙƒÙ†Øª Ø£Ù†Øª Ø§Ù„Ù…ØªØ¨Ø±Ø¹ -->
        <!-- ============================================ -->
        <div class="section">
            <div class="section-header">
                <div>
                    <div class="section-title">
                        <span class="section-title-icon">ğŸ¯</span>
                        Ù„Ùˆ ÙƒÙ†Øª Ø£Ù†Øª Ø§Ù„Ù…ØªØ¨Ø±Ø¹...
                    </div>
                    <div class="section-subtitle">ÙˆØ¬Ù‡Ø© Ù†Ø¸Ø± Ø§Ù„Ù…ØªØ¨Ø±Ø¹ÙŠÙ† Ù…Ù† Ø¯Ø§Ø®Ù„ Ø§Ù„ÙØ±ÙŠÙ‚</div>
                </div>
                <div class="section-actions">
                    <button class="btn btn-secondary" onclick="exportSectionData('donor-perspective')">
                        ğŸ“¥ ØªØµØ¯ÙŠØ± Ø§Ù„Ù‚Ø³Ù…
                    </button>
                </div>
            </div>
            
            <!-- Reasons to Donate -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ’š Ù…Ø§ ÙŠØ¬Ø¹Ù„Ù†ÙŠ Ø£ØªØ¨Ø±Ø¹ ÙÙŠ Ø§Ù„Ù†Ø®ÙŠÙ„ Ù„Ø£ÙˆÙ„ Ù…Ø±Ø©
                </h3>
                <canvas id="chart-reasons-donate" style="max-height: 350px;"></canvas>
            </div>
            
            <!-- Reasons to Repeat -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ” Ù…Ø§ ÙŠØ¬Ø¹Ù„Ù†ÙŠ Ø£ÙƒØ±Ø± Ø§Ù„ØªØ¨Ø±Ø¹
                </h3>
                <canvas id="chart-reasons-repeat" style="max-height: 350px;"></canvas>
            </div>
            
            <!-- Reasons to Refer -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ“¢ Ù…Ø§ ÙŠØ¬Ø¹Ù„Ù†ÙŠ Ø£Ø±Ø´Ø­ ØºÙŠØ±ÙŠ Ù„Ù„ØªØ¨Ø±Ø¹
                </h3>
                <canvas id="chart-reasons-refer" style="max-height: 300px;"></canvas>
            </div>
            
            <!-- Reasons to Stop -->
            <div>
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ›‘ Ù…Ø§ ÙŠØ¬Ø¹Ù„Ù†ÙŠ Ø£ØªÙˆÙ‚Ù Ø¹Ù† Ø§Ù„ØªØ¨Ø±Ø¹ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹
                </h3>
                <canvas id="chart-reasons-stop" style="max-height: 300px;"></canvas>
                <div style="margin-top: 15px; padding: 15px; background: #f8d7da; border-radius: 10px; border-right: 4px solid var(--danger);">
                    <strong>âš ï¸ ØªØ­Ø°ÙŠØ±Ø§Øª Ø­Ø±Ø¬Ø©:</strong> Ù‡Ø°Ù‡ Ø§Ù„Ø¹ÙˆØ§Ù…Ù„ ÙŠØ¬Ø¨ ØªØ¬Ù†Ø¨Ù‡Ø§ Ø¨Ø£ÙŠ Ø«Ù…Ù†!
                </div>
            </div>
        </div>

        <!-- ============================================ -->
        <!-- Section 10: Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø§Øª ÙˆØ§Ù„Ø­Ù„ÙˆÙ„ -->
        <!-- ============================================ -->
        <div class="section">
            <div class="section-header">
                <div>
                    <div class="section-title">
                        <span class="section-title-icon">ğŸ’¡</span>
                        Ù…Ù‚ØªØ±Ø­Ø§Øª ÙˆØ­Ù„ÙˆÙ„ Ø§Ù„ÙØ±ÙŠÙ‚
                    </div>
                    <div class="section-subtitle">Ø§Ù„Ø£ÙÙƒØ§Ø± Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ÙŠØ© Ù…Ù† Ø§Ù„Ù…ÙŠØ¯Ø§Ù†</div>
                </div>
                <div class="section-actions">
                    <button class="btn btn-secondary" onclick="exportSectionData('suggestions')">
                        ğŸ“¥ ØªØµØ¯ÙŠØ± Ø§Ù„Ù‚Ø³Ù…
                    </button>
                </div>
            </div>
            
            <!-- Magic Wand - 3 Fixes -->
            <div style="margin-bottom: 30px; padding: 25px; background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%); border-radius: 15px; border: 3px solid var(--warning);">
                <h3 style="margin-bottom: 20px; color: var(--dark); font-size: 18px; font-weight: 700; text-align: center;">
                    âœ¨ Ø§Ù„Ø¹ØµØ§ Ø§Ù„Ø³Ø­Ø±ÙŠØ© - Ø£Ù‡Ù… 3 Ø£Ø´ÙŠØ§Ø¡ Ù„Ù„Ø¥ØµÙ„Ø§Ø­
                </h3>
                <div id="magic-fixes-list" style="max-height: 500px; overflow-y: auto;">
                    Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...
                </div>
            </div>
            
            <!-- Creative Ideas -->
            <div style="margin-bottom: 30px; padding: 25px; background: linear-gradient(135deg, #a29bfe 0%, #6c5ce7 100%); border-radius: 15px; color: white;">
                <h3 style="margin-bottom: 20px; font-size: 18px; font-weight: 700; text-align: center;">
                    ğŸš€ Ø§Ù„Ø£ÙÙƒØ§Ø± Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ÙŠØ© Ù„Ù„ØªØ³ÙˆÙŠÙ‚
                </h3>
                <div id="creative-ideas-list" style="max-height: 500px; overflow-y: auto;">
                    Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...
                </div>
            </div>
            
            <!-- Competitive Edge -->
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--dark); font-size: 16px; font-weight: 600;">
                    ğŸ† Ø§Ù„Ù…ÙŠØ²Ø© Ø§Ù„ØªÙ†Ø§ÙØ³ÙŠØ© Ø§Ù„Ø£Ù‚ÙˆÙ‰ Ù„Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„ÙŠÙ‡Ø§
                </h3>
                <canvas id="chart-competitive-edge" style="max-height: 300px;"></canvas>
            </div>
            
            <!-- Final Messages -->
            <div style="padding: 25px; background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%); border-radius: 15px; color: white; box-shadow: 0 8px 25px rgba(46, 204, 113, 0.3);">
                <h3 style="margin-bottom: 20px; font-size: 18px; font-weight: 700; text-align: center;">
                    ğŸ’¬ Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ÙØ±ÙŠÙ‚ Ù„ÙˆØ±Ø´Ø© 20 Ù†ÙˆÙÙ…Ø¨Ø±
                </h3>
                <div id="final-messages-list" style="max-height: 500px; overflow-y: auto;">
                    Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...
                </div>
            </div>
        </div>

        <!-- ============================================ -->
        <!-- Section: AI Analysis & Insights -->
        <!-- ============================================ -->
        <div class="section">
            <div class="section-header">
                <div>
                    <div class="section-title">
                        <span class="section-title-icon">ğŸ¤–</span>
                        ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ÙˆØ§Ù„Ø±Ø¤Ù‰ Ø§Ù„Ø¹Ù…ÙŠÙ‚Ø©
                    </div>
                    <div class="section-subtitle">ØªØ­Ù„ÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø´Ø§Ù…Ù„ Ù„ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</div>
                </div>
                <div class="section-actions">
                    <button class="btn btn-primary" onclick="triggerAIAnalysis()" id="ai-analysis-btn">
                        ğŸ§  ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ
                    </button>
                    <button class="btn btn-secondary" onclick="exportAIAnalysis()">
                        ğŸ“¥ ØªØµØ¯ÙŠØ± Ø§Ù„ØªØ­Ù„ÙŠÙ„
                    </button>
                </div>
            </div>
            
            <div id="ai-analysis-container" style="display: none;">
                <!-- Top 5 Critical Issues -->
                <div style="margin-bottom: 30px; padding: 25px; background: #f8d7da; border-radius: 15px; border-right: 5px solid var(--danger);">
                    <h3 style="margin-bottom: 20px; color: var(--dark); font-size: 18px; font-weight: 700;">
                        ğŸš¨ Ø£Ù‡Ù… 5 Ù‚Ø¶Ø§ÙŠØ§ Ø­Ø±Ø¬Ø©
                    </h3>
                    <div id="ai-critical-issues" style="font-size: 15px; line-height: 2;">
                        Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„...
                    </div>
                </div>
                
                <!-- Quick Wins -->
                <div style="margin-bottom: 30px; padding: 25px; background: #d4edda; border-radius: 15px; border-right: 5px solid var(--success);">
                    <h3 style="margin-bottom: 20px; color: var(--dark); font-size: 18px; font-weight: 700;">
                        âš¡ Quick Wins - Ù†ØªØ§Ø¦Ø¬ Ø³Ø±ÙŠØ¹Ø©
                    </h3>
                    <div id="ai-quick-wins" style="font-size: 15px; line-height: 2;">
                        Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„...
                    </div>
                </div>
                
                <!-- Patterns & Trends -->
                <div style="margin-bottom: 30px; padding: 25px; background: #e7f3ff; border-radius: 15px; border-right: 5px solid var(--secondary);">
                    <h3 style="margin-bottom: 20px; color: var(--dark); font-size: 18px; font-weight: 700;">
                        ğŸ“ˆ Ø§Ù„Ø£Ù†Ù…Ø§Ø· ÙˆØ§Ù„Ø§ØªØ¬Ø§Ù‡Ø§Øª Ø§Ù„Ù…ÙƒØªØ´ÙØ©
                    </h3>
                    <div id="ai-patterns" style="font-size: 15px; line-height: 2;">
                        Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„...
                    </div>
                </div>
                
                <!-- Strategic Recommendations -->
                <div style="padding: 25px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 15px; color: white;">
                    <h3 style="margin-bottom: 20px; font-size: 18px; font-weight: 700;">
                        ğŸ¯ Ø§Ù„ØªÙˆØµÙŠØ§Øª Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ù„Ù„ÙˆØ±Ø´Ø©
                    </h3>
                    <div id="ai-recommendations" style="font-size: 15px; line-height: 2;">
                        Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„...
                    </div>
                </div>
            </div>
            
            <div id="ai-analysis-placeholder" style="text-align: center; padding: 60px 20px; color: var(--gray);">
                <div style="font-size: 64px; margin-bottom: 20px;">ğŸ¤–</div>
                <h3 style="font-size: 20px; margin-bottom: 10px;">Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ ØºÙŠØ± Ù…ÙØ¹Ù‘Ù„ Ø¨Ø¹Ø¯</h3>
                <p style="font-size: 15px;">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ "ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ" Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø±Ø¤Ù‰ Ø¹Ù…ÙŠÙ‚Ø© Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</p>
            </div>
        </div>

        <!-- ============================================ -->
        <!-- Section: Raw Data Table -->
        <!-- ============================================ -->
        <div class="section">
            <div class="section-header">
                <div>
                    <div class="section-title">
                        <span class="section-title-icon">ğŸ“‹</span>
                        Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø§Ù… (Raw Data)
                    </div>
                    <div class="section-subtitle">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø§Øª Ø¨Ø§Ù„ØªÙØµÙŠÙ„</div>
                </div>
                <div class="section-actions">
                    <button class="btn btn-secondary" onclick="exportRawData()">
                        ğŸ“¥ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¬Ø¯ÙˆÙ„
                    </button>
                    <button class="btn btn-warning" onclick="deleteAllResponses()">
                        ğŸ—‘ï¸ Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                    </button>
                </div>
            </div>
            
            <div style="overflow-x: auto;">
                <table id="raw-data-table" style="width: 100%; border-collapse: collapse; font-size: 13px;">
                    <thead style="background: var(--primary); color: white; position: sticky; top: 0;">
                        <tr>
                            <th style="padding: 12px; text-align: right; border: 1px solid #ddd;">#</th>
                            <th style="padding: 12px; text-align: right; border: 1px solid #ddd;">Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                            <th style="padding: 12px; text-align: right; border: 1px solid #ddd;">Ø§Ù„Ù‚Ø³Ù…</th>
                            <th style="padding: 12px; text-align: right; border: 1px solid #ddd;">Ø§Ù„Ø®Ø¨Ø±Ø©</th>
                            <th style="padding: 12px; text-align: right; border: 1px solid #ddd;">Ø§Ù„Ù…Ø¹Ø±ÙØ© (1-10)</th>
                            <th style="padding: 12px; text-align: right; border: 1px solid #ddd;">Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„Ø´Ø®ØµÙŠØ©</th>
                            <th style="padding: 12px; text-align: right; border: 1px solid #ddd;">Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„ÙØ±ÙŠÙ‚</th>
                            <th style="padding: 12px; text-align: right; border: 1px solid #ddd;">Ù‡Ù„ Ø§Ù„Ù‡Ø¯Ù Ù…Ù…ÙƒÙ†ØŸ</th>
                            <th style="padding: 12px; text-align: right; border: 1px solid #ddd;">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                        </tr>
                    </thead>
                    <tbody id="raw-data-tbody">
                        <tr>
                            <td colspan="9" style="padding: 40px; text-align: center; color: var(--gray);">
                                Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <!-- Config -->
    <script src="../config.js"></script>
    <!-- Main JavaScript -->
    <script>
        // ============================================
        // Initialize Firebase
        // ============================================
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        // Force clear cache on every load
db.clearPersistence().catch(() => {});
        
        // ============================================
        // Global Variables
        // ============================================
        let allResponses = [];
        let filteredResponses = [];
        let charts = {};
        
        // ============================================
        // Page Load
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            loadAllData();
        });
        
        // ============================================
        // Load All Data
        // ============================================
        // ============================================
        // Load All Data - FIXED VERSION
        // ============================================
        async function loadAllData() {
            showLoading(true);
            
            try {
                console.log('ğŸ”„ Starting fresh data load...');
                
                // Force get from server, not cache
                const snapshot = await db.collection('palm-trees-survey')
                    .get({ source: 'server' });
                
                allResponses = [];
                
                if (snapshot.empty) {
                    console.warn('âš ï¸ No data found');
                    document.getElementById('total-responses').textContent = '0';
                    showLoading(false);
                    return;
                }
                
                snapshot.forEach(doc => {
                    allResponses.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                
                console.log(`âœ… Loaded ${allResponses.length} responses`);
                
                filteredResponses = [...allResponses];
                
                // Update UI
                updateOverviewStats();
                createAllCharts();
                populateTextLists();
                populateRawDataTable();
                
                showLoading(false);
                
            } catch (error) {
                console.error('âŒ Load error:', error);
                showLoading(false);
                
                // Fallback: try cache if server fails
                console.log('ğŸ”„ Trying cache fallback...');
                try {
                    const cacheSnapshot = await db.collection('palm-trees-survey')
                        .get({ source: 'cache' });
                    
                    if (!cacheSnapshot.empty) {
                        allResponses = [];
                        cacheSnapshot.forEach(doc => {
                            allResponses.push({
                                id: doc.id,
                                ...doc.data()
                            });
                        });
                        
                        console.log(`âœ… Loaded ${allResponses.length} from cache`);
                        filteredResponses = [...allResponses];
                        updateOverviewStats();
                        createAllCharts();
                        populateTextLists();
                        populateRawDataTable();
                    } else {
                        alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª. Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.');
                    }
                } catch (cacheError) {
                    console.error('âŒ Cache also failed:', cacheError);
                    alert('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©.');
                }
            }
        }
        
        // ============================================
        // Refresh Data
        // ============================================
        function refreshData() {
            loadAllData();
        }
        
        // ============================================
        // Show/Hide Loading
        // ============================================
        function showLoading(show) {
            const overlay = document.getElementById('loading-overlay');
            const headerLoading = document.getElementById('header-loading');
            
            if (show) {
                overlay.classList.add('active');
                headerLoading.classList.add('active');
            } else {
                overlay.classList.remove('active');
                headerLoading.classList.remove('active');
            }
        }
        
        // ============================================
        // Update Overview Stats
        // ============================================
        function updateOverviewStats() {
            const total = filteredResponses.length;
            document.getElementById('total-responses').textContent = total;
            
            // Completion Rate
            const targetParticipants = 150;
            const completionRate = ((total / targetParticipants) * 100).toFixed(1);
            document.getElementById('completion-rate').textContent = completionRate + '%';
            document.getElementById('completion-change').textContent = `Ù…Ù† Ø£ØµÙ„ ${targetParticipants} Ù…ÙˆØ¸Ù`;
            
            // Average Time (mock - we don't track actual time)
            document.getElementById('avg-time').textContent = '~16 Ø¯Ù‚ÙŠÙ‚Ø©';
            
            // Average Readiness
            const readinessValues = filteredResponses
                .map(r => parseInt(r.personal_readiness))
                .filter(r => !isNaN(r));
            
            if (readinessValues.length > 0) {
                const avgReadiness = (readinessValues.reduce((a, b) => a + b, 0) / readinessValues.length).toFixed(1);
                document.getElementById('readiness-avg').textContent = avgReadiness + '/10';
            } else {
                document.getElementById('readiness-avg').textContent = '-';
            }
        }
        
        // ============================================
        // Apply Filters
        // ============================================
        function applyFilters() {
            const deptFilter = document.getElementById('filter-department').value;
            const expFilter = document.getElementById('filter-experience').value;
            const readinessFilter = document.getElementById('filter-readiness').value;
            const searchText = document.getElementById('filter-search').value.toLowerCase();
            
            filteredResponses = allResponses.filter(response => {
                // Department filter
                if (deptFilter !== 'all' && response.department !== deptFilter) {
                    return false;
                }
                
                // Experience filter
                if (expFilter !== 'all' && response.experience !== expFilter) {
                    return false;
                }
                
                // Readiness filter
                if (readinessFilter !== 'all') {
                    const readiness = parseInt(response.personal_readiness);
                    if (readinessFilter === 'high' && readiness < 8) return false;
                    if (readinessFilter === 'medium' && (readiness < 5 || readiness > 7)) return false;
                    if (readinessFilter === 'low' && readiness > 4) return false;
                }
                
                // Search filter
                if (searchText) {
                    const searchableText = JSON.stringify(response).toLowerCase();
                    if (!searchableText.includes(searchText)) {
                        return false;
                    }
                }
                
                return true;
            });
            
            // Re-render everything
            updateOverviewStats();
            createAllCharts();
            populateTextLists();
            populateRawDataTable();
        }
        
        // ============================================
        // Count Values Helper
        // ============================================
        function countValues(fieldName) {
            const counts = {};
            
            filteredResponses.forEach(response => {
                const value = response[fieldName];
                if (value) {
                    if (Array.isArray(value)) {
                        value.forEach(v => {
                            counts[v] = (counts[v] || 0) + 1;
                        });
                    } else {
                        counts[value] = (counts[value] || 0) + 1;
                    }
                }
            });
            
            return counts;
        }
        
        // ============================================
        // Create Chart Helper
        // ============================================
        function createChart(canvasId, type, data, options = {}) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;
            
            // Destroy existing chart
            if (charts[canvasId]) {
                charts[canvasId].destroy();
            }
            
            const ctx = canvas.getContext('2d');
            charts[canvasId] = new Chart(ctx, {
                type: type,
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            rtl: true,
                            labels: {
                                font: {
                                    family: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",
                                    size: 12
                                },
                                padding: 15,
                                usePointStyle: true
                            }
                        },
                        tooltip: {
                            rtl: true,
                            titleFont: {
                                family: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"
                            },
                            bodyFont: {
                                family: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"
                            }
                        }
                    },
                    ...options
                }
            });
        }
        
        // ============================================
        // Create All Charts
        // ============================================
        function createAllCharts() {
            createDemographicsCharts();
            createUnderstandingCharts();
            createPerformance2025Charts();
            createCompetitionCharts();
            createMarketingCharts();
            createCoordinationCharts();
            createTimingCharts();
            createReadinessCharts();
            createDonorPerspectiveCharts();
            createSuggestionsCharts();
        }
        
        // ============================================
        // Demographics Charts
        // ============================================
        function createDemographicsCharts() {
            // Departments
            const deptCounts = countValues('department');
            createChart('chart-departments', 'doughnut', {
                labels: Object.keys(deptCounts),
                datasets: [{
                    data: Object.values(deptCounts),
                    backgroundColor: [
                        '#2ecc71', '#3498db', '#9b59b6', '#f39c12',
                        '#e74c3c', '#1abc9c', '#34495e', '#16a085',
                        '#27ae60', '#2980b9'
                    ]
                }]
            });
            
            // Experience
            const expOrder = [
                'Ø£Ù‚Ù„ Ù…Ù† 6 Ø´Ù‡ÙˆØ±',
                '6 Ø´Ù‡ÙˆØ± - Ø³Ù†Ø©',
                '1-3 Ø³Ù†ÙˆØ§Øª',
                '3-5 Ø³Ù†ÙˆØ§Øª',
                'Ø£ÙƒØ«Ø± Ù…Ù† 5 Ø³Ù†ÙˆØ§Øª'
            ];
            const expCounts = countValues('experience');
            createChart('chart-experience', 'bar', {
                labels: expOrder,
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†',
                    data: expOrder.map(exp => expCounts[exp] || 0),
                    backgroundColor: '#3498db'
                }]
            }, {
                indexAxis: 'y',
                scales: {
                    x: {
                        beginAtZero: true,
                        ticks: { stepSize: 1 }
                    }
                }
            });
            
            // Worked on Palm
            const workedCounts = countValues('worked_on_palm');
            createChart('chart-worked-palm', 'pie', {
                labels: Object.keys(workedCounts),
                datasets: [{
                    data: Object.values(workedCounts),
                    backgroundColor: ['#2ecc71', '#27ae60', '#f39c12', '#95a5a6']
                }]
            });
            
            // Items Count
            const itemsCounts = countValues('items_count');
            createChart('chart-items-count', 'doughnut', {
                labels: Object.keys(itemsCounts),
                datasets: [{
                    data: Object.values(itemsCounts),
                    backgroundColor: ['#2ecc71', '#3498db', '#f39c12', '#e74c3c']
                }]
            });
            
            // Knowledge Rating (1-10)
            const knowledgeRatings = filteredResponses
                .map(r => parseInt(r.palm_knowledge))
                .filter(r => !isNaN(r));
            
            const knowledgeCounts = {};
            for (let i = 1; i <= 10; i++) {
                knowledgeCounts[i] = knowledgeRatings.filter(r => r === i).length;
            }
            
            createChart('chart-knowledge-rating', 'bar', {
                labels: Object.keys(knowledgeCounts),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†',
                    data: Object.values(knowledgeCounts),
                    backgroundColor: '#2ecc71'
                }]
            }, {
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: { stepSize: 1 }
                    }
                }
            });
            
            // Knowledge Stats
            if (knowledgeRatings.length > 0) {
                const avg = (knowledgeRatings.reduce((a, b) => a + b, 0) / knowledgeRatings.length).toFixed(1);
                const min = Math.min(...knowledgeRatings);
                const max = Math.max(...knowledgeRatings);
                const low = knowledgeRatings.filter(r => r <= 4).length;
                const medium = knowledgeRatings.filter(r => r >= 5 && r <= 7).length;
                const high = knowledgeRatings.filter(r => r >= 8).length;
                
                document.getElementById('knowledge-stats').innerHTML = `
                    Ù…ØªÙˆØ³Ø· Ø§Ù„Ù…Ø¹Ø±ÙØ©: <strong>${avg}/10</strong> | 
                    Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰: <strong>${min}</strong> | 
                    Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰: <strong>${max}</strong><br>
                    Ù…Ø¹Ø±ÙØ© Ø¶Ø¹ÙŠÙØ© (1-4): <strong>${low}</strong> | 
                    Ù…Ø¹Ø±ÙØ© Ù…ØªÙˆØ³Ø·Ø© (5-7): <strong>${medium}</strong> | 
                    Ù…Ø¹Ø±ÙØ© Ø¹Ø§Ù„ÙŠØ© (8-10): <strong>${high}</strong>
                `;
            }
        }
        
        // ============================================
        // Understanding Charts
        // ============================================
        function createUnderstandingCharts() {
            // Understanding Level
            const understandingOrder = [
                '5 - Ø£ÙÙ‡Ù…Ù‡ Ø¨Ø¹Ù…Ù‚',
                '4 - Ø£ÙÙ‡Ù… Ø§Ù„ÙÙƒØ±Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©',
                '3 - ÙÙ‡Ù… Ø³Ø·Ø­ÙŠ',
                '2 - ÙÙ‡Ù… Ø¶Ø¹ÙŠÙ',
                '1 - Ù„Ø§ Ø£ÙÙ‡Ù…Ù‡ Ø¬ÙŠØ¯Ø§Ù‹'
            ];
            const understandingCounts = countValues('understanding_level');
            createChart('chart-understanding', 'bar', {
                labels: understandingOrder,
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†',
                    data: understandingOrder.map(u => understandingCounts[u] || 0),
                    backgroundColor: '#3498db'
                }]
            }, {
                indexAxis: 'y'
            });
            
            // Info Sufficient
            const infoCounts = countValues('info_sufficient');
            createChart('chart-info-sufficient', 'pie', {
                labels: Object.keys(infoCounts),
                datasets: [{
                    data: Object.values(infoCounts),
                    backgroundColor: ['#2ecc71', '#3498db', '#f39c12', '#e74c3c']
                }]
            });
            
            // Missing Info
            const missingCounts = countValues('missing_info');
            const sortedMissing = Object.entries(missingCounts)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10);
            
            createChart('chart-missing-info', 'bar', {
                labels: sortedMissing.map(m => m[0]),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª',
                    data: sortedMissing.map(m => m[1]),
                    backgroundColor: '#f39c12'
                }]
            }, {
                indexAxis: 'y'
            });
            
            // Explanation Difficulty
            const diffCounts = countValues('explanation_difficulty');
            createChart('chart-explanation-difficulty', 'doughnut', {
                labels: Object.keys(diffCounts),
                datasets: [{
                    data: Object.values(diffCounts),
                    backgroundColor: ['#e74c3c', '#f39c12', '#3498db', '#2ecc71']
                }]
            });
            
            // Palm Difficulty
            const palmDiffCounts = countValues('palm_difficulty');
            const sortedPalmDiff = Object.entries(palmDiffCounts)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10);
            
            createChart('chart-palm-difficulty', 'bar', {
                labels: sortedPalmDiff.map(p => p[0]),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª',
                    data: sortedPalmDiff.map(p => p[1]),
                    backgroundColor: '#e74c3c'
                }]
            }, {
                indexAxis: 'y'
            });
            
            // Easiest Item
            const easiestCounts = countValues('easiest_item');
            createChart('chart-easiest-item', 'bar', {
                labels: Object.keys(easiestCounts),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª',
                    data: Object.values(easiestCounts),
                    backgroundColor: '#2ecc71'
                }]
            }, {
                indexAxis: 'y'
            });
        }
        
        // ============================================
        // Performance 2025 Charts
        // ============================================
        function createPerformance2025Charts() {
            // Know Target
            const targetCounts = countValues('know_target');
            createChart('chart-know-target', 'doughnut', {
                labels: Object.keys(targetCounts),
                datasets: [{
                    data: Object.values(targetCounts),
                    backgroundColor: ['#2ecc71', '#3498db', '#f39c12', '#e74c3c']
                }]
            });
            
            // Failure Reasons
            const failureCounts = countValues('failure_reasons');
            const sortedFailure = Object.entries(failureCounts)
                .sort((a, b) => b[1] - a[1]);
            
            createChart('chart-failure-reasons', 'bar', {
                labels: sortedFailure.map(f => f[0]),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª',
                    data: sortedFailure.map(f => f[1]),
                    backgroundColor: '#e74c3c'
                }]
            }, {
                indexAxis: 'y'
            });
            
            // Critical Analysis
            if (sortedFailure.length > 0) {
                const top3 = sortedFailure.slice(0, 3);
                document.getElementById('critical-analysis').innerHTML = `
                    Ø§Ù„Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ø«Ù„Ø§Ø«Ø© Ø§Ù„Ø£ÙƒØ«Ø± ØªÙƒØ±Ø§Ø±Ø§Ù‹:<br>
                    1ï¸âƒ£ <strong>${top3[0][0]}</strong> (${top3[0][1]} Ø°ÙƒØ±)<br>
                    ${top3[1] ? `2ï¸âƒ£ <strong>${top3[1][0]}</strong> (${top3[1][1]} Ø°ÙƒØ±)<br>` : ''}
                    ${top3[2] ? `3ï¸âƒ£ <strong>${top3[2][0]}</strong> (${top3[2][1]} Ø°ÙƒØ±)` : ''}
                `;
            }
            
            // Strong Period
            const strongCounts = countValues('strong_period');
            createChart('chart-strong-period', 'pie', {
                labels: Object.keys(strongCounts),
                datasets: [{
                    data: Object.values(strongCounts),
                    backgroundColor: ['#2ecc71', '#3498db', '#f39c12', '#e74c3c', '#9b59b6', '#95a5a6']
                }]
            });
            
            // Weak Period
            const weakCounts = countValues('weak_period');
            createChart('chart-weak-period', 'pie', {
                labels: Object.keys(weakCounts),
                datasets: [{
                    data: Object.values(weakCounts),
                    backgroundColor: ['#e74c3c', '#f39c12', '#95a5a6', '#34495e']
                }]
            });
            
            // Documentation Impact
            const docCounts = countValues('documentation_impact');
            createChart('chart-doc-impact', 'bar', {
                labels: Object.keys(docCounts),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†',
                    data: Object.values(docCounts),
                    backgroundColor: '#3498db'
                }]
            }, {
                indexAxis: 'y'
            });
            
            // Umrah Impact
            const umrahCounts = countValues('umrah_draw_impact');
            createChart('chart-umrah-impact', 'doughnut', {
                labels: Object.keys(umrahCounts),
                datasets: [{
                    data: Object.values(umrahCounts),
                    backgroundColor: ['#2ecc71', '#3498db', '#95a5a6', '#e0e0e0']
                }]
            });
            
            // Hardest Stage
            const stageCounts = countValues('hardest_stage');
            createChart('chart-hardest-stage', 'bar', {
                labels: Object.keys(stageCounts),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª',
                    data: Object.values(stageCounts),
                    backgroundColor: '#f39c12'
                }]
            }, {
                indexAxis: 'y'
            });
        }
      

        // ============================================
        // Competition Charts
        // ============================================
        function createCompetitionCharts() {
            // Know Competitors
            const compCounts = countValues('know_competitors');
            createChart('chart-know-competitors', 'doughnut', {
                labels: Object.keys(compCounts),
                datasets: [{
                    data: Object.values(compCounts),
                    backgroundColor: ['#2ecc71', '#3498db', '#f39c12', '#e74c3c']
                }]
            });
            
            // Our Advantages
            const advCounts = countValues('our_advantages');
            const sortedAdv = Object.entries(advCounts)
                .sort((a, b) => b[1] - a[1]);
            
            createChart('chart-our-advantages', 'bar', {
                labels: sortedAdv.map(a => a[0]),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª',
                    data: sortedAdv.map(a => a[1]),
                    backgroundColor: '#2ecc71'
                }]
            }, {
                indexAxis: 'y'
            });
            
            // Competitor Objections
            const objCounts = countValues('competitor_objection');
            createChart('chart-competitor-objections', 'bar', {
                labels: Object.keys(objCounts),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†',
                    data: Object.values(objCounts),
                    backgroundColor: '#e74c3c'
                }]
            }, {
                indexAxis: 'y'
            });
            
            // Internal Competition
            const internalCounts = countValues('internal_competition');
            const sortedInternal = Object.entries(internalCounts)
                .sort((a, b) => b[1] - a[1]);
            
            createChart('chart-internal-competition', 'bar', {
                labels: sortedInternal.map(i => i[0]),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª',
                    data: sortedInternal.map(i => i[1]),
                    backgroundColor: '#f39c12'
                }]
            }, {
                indexAxis: 'y'
            });
            
            // Items Conflict
            const conflictCounts = countValues('items_conflict');
            createChart('chart-items-conflict', 'doughnut', {
                labels: Object.keys(conflictCounts),
                datasets: [{
                    data: Object.values(conflictCounts),
                    backgroundColor: ['#e74c3c', '#f39c12', '#3498db', '#2ecc71']
                }]
            });
            
            // Multi-Item Solution
            const solutionCounts = countValues('multi_item_solution');
            createChart('chart-multi-item-solution', 'bar', {
                labels: Object.keys(solutionCounts),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª',
                    data: Object.values(solutionCounts),
                    backgroundColor: '#3498db'
                }]
            }, {
                indexAxis: 'y'
            });
        }
        
        // ============================================
        // Marketing Charts
        // ============================================
        function createMarketingCharts() {
            // Content Quality (1-10)
            const contentRatings = filteredResponses
                .map(r => parseInt(r.content_quality))
                .filter(r => !isNaN(r));
            
            const contentCounts = {};
            for (let i = 1; i <= 10; i++) {
                contentCounts[i] = contentRatings.filter(r => r === i).length;
            }
            
            createChart('chart-content-quality', 'bar', {
                labels: Object.keys(contentCounts),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†',
                    data: Object.values(contentCounts),
                    backgroundColor: '#3498db'
                }]
            }, {
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: { stepSize: 1 }
                    }
                }
            });
            
            // Content Quality Stats
            if (contentRatings.length > 0) {
                const avg = (contentRatings.reduce((a, b) => a + b, 0) / contentRatings.length).toFixed(1);
                const low = contentRatings.filter(r => r <= 4).length;
                const medium = contentRatings.filter(r => r >= 5 && r <= 7).length;
                const high = contentRatings.filter(r => r >= 8).length;
                
                document.getElementById('content-quality-stats').innerHTML = `
                    Ù…ØªÙˆØ³Ø· Ø§Ù„ØªÙ‚ÙŠÙŠÙ…: <strong>${avg}/10</strong><br>
                    Ø¶Ø¹ÙŠÙ (1-4): <strong>${low}</strong> | 
                    Ù…ØªÙˆØ³Ø· (5-7): <strong>${medium}</strong> | 
                    Ù…Ù…ØªØ§Ø² (8-10): <strong>${high}</strong>
                `;
            }
            
            // Most Effective Content
            const effectiveCounts = countValues('most_effective_content');
            createChart('chart-effective-content', 'bar', {
                labels: Object.keys(effectiveCounts),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª',
                    data: Object.values(effectiveCounts),
                    backgroundColor: '#2ecc71'
                }]
            }, {
                indexAxis: 'y'
            });
            
            // Messages Clarity
            const clarityCounts = countValues('messages_clarity');
            createChart('chart-messages-clarity', 'doughnut', {
                labels: Object.keys(clarityCounts),
                datasets: [{
                    data: Object.values(clarityCounts),
                    backgroundColor: ['#2ecc71', '#3498db', '#f39c12', '#e74c3c', '#95a5a6']
                }]
            });
            
            // Best Message
            const messageCounts = countValues('best_message');
            const sortedMessages = Object.entries(messageCounts)
                .sort((a, b) => b[1] - a[1]);
            
            createChart('chart-best-message', 'bar', {
                labels: sortedMessages.map(m => m[0]),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª',
                    data: sortedMessages.map(m => m[1]),
                    backgroundColor: '#f39c12'
                }]
            }, {
                indexAxis: 'y'
            });
            
            // Main Objection
            const objectionCounts = countValues('main_objection');
            const sortedObjections = Object.entries(objectionCounts)
                .sort((a, b) => b[1] - a[1]);
            
            createChart('chart-main-objection', 'bar', {
                labels: sortedObjections.map(o => o[0]),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª',
                    data: sortedObjections.map(o => o[1]),
                    backgroundColor: '#e74c3c'
                }]
            }, {
                indexAxis: 'y'
            });
            
            // Ready Answers
            const answersCounts = countValues('ready_answers');
            createChart('chart-ready-answers', 'bar', {
                labels: Object.keys(answersCounts),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†',
                    data: Object.values(answersCounts),
                    backgroundColor: '#3498db'
                }]
            }, {
                indexAxis: 'y'
            });
            
            // Ad Channels
            const channelsCounts = countValues('ad_channels');
            const sortedChannels = Object.entries(channelsCounts)
                .sort((a, b) => b[1] - a[1]);
            
            createChart('chart-ad-channels', 'bar', {
                labels: sortedChannels.map(c => c[0]),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª',
                    data: sortedChannels.map(c => c[1]),
                    backgroundColor: '#9b59b6'
                }]
            }, {
                indexAxis: 'y'
            });
        }
        
        // ============================================
        // Coordination Charts
        // ============================================
        function createCoordinationCharts() {
            // Coordination Quality (1-10)
            const coordRatings = filteredResponses
                .map(r => parseInt(r.coordination_quality))
                .filter(r => !isNaN(r));
            
            const coordCounts = {};
            for (let i = 1; i <= 10; i++) {
                coordCounts[i] = coordRatings.filter(r => r === i).length;
            }
            
            createChart('chart-coordination-quality', 'bar', {
                labels: Object.keys(coordCounts),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†',
                    data: Object.values(coordCounts),
                    backgroundColor: '#3498db'
                }]
            }, {
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: { stepSize: 1 }
                    }
                }
            });
            
            // Coordination Stats
            if (coordRatings.length > 0) {
                const avg = (coordRatings.reduce((a, b) => a + b, 0) / coordRatings.length).toFixed(1);
                const poor = coordRatings.filter(r => r <= 4).length;
                const average = coordRatings.filter(r => r >= 5 && r <= 7).length;
                const excellent = coordRatings.filter(r => r >= 8).length;
                
                document.getElementById('coordination-stats').innerHTML = `
                    Ù…ØªÙˆØ³Ø· Ø§Ù„ØªÙ‚ÙŠÙŠÙ…: <strong>${avg}/10</strong><br>
                    Ø¶Ø¹ÙŠÙ (1-4): <strong>${poor}</strong> | 
                    Ù…ØªÙˆØ³Ø· (5-7): <strong>${average}</strong> | 
                    Ù…Ù…ØªØ§Ø² (8-10): <strong>${excellent}</strong>
                `;
            }
            
            // Coordination Problems
            const problemsCounts = countValues('coordination_problems');
            const sortedProblems = Object.entries(problemsCounts)
                .sort((a, b) => b[1] - a[1]);
            
            createChart('chart-coordination-problems', 'bar', {
                labels: sortedProblems.map(p => p[0]),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª',
                    data: sortedProblems.map(p => p[1]),
                    backgroundColor: '#e74c3c'
                }]
            }, {
                indexAxis: 'y'
            });
            
            // SLA Existence
            const slaCounts = countValues('sla_existence');
            createChart('chart-sla-existence', 'doughnut', {
                labels: Object.keys(slaCounts),
                datasets: [{
                    data: Object.values(slaCounts),
                    backgroundColor: ['#2ecc71', '#3498db', '#f39c12', '#e74c3c', '#95a5a6']
                }]
            });
            
            // Problem Resolution
            const resolutionCounts = countValues('problem_resolution');
            createChart('chart-problem-resolution', 'bar', {
                labels: Object.keys(resolutionCounts),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†',
                    data: Object.values(resolutionCounts),
                    backgroundColor: '#f39c12'
                }]
            }, {
                indexAxis: 'y'
            });
            
            // Needs from Programs
            const needsCounts = countValues('needs_from_programs');
            const sortedNeeds = Object.entries(needsCounts)
                .sort((a, b) => b[1] - a[1]);
            
            createChart('chart-needs-from-programs', 'bar', {
                labels: sortedNeeds.map(n => n[0]),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª',
                    data: sortedNeeds.map(n => n[1]),
                    backgroundColor: '#3498db'
                }]
            }, {
                indexAxis: 'y'
            });
        }
        
        // ============================================
        // Timing Charts
        // ============================================
        function createTimingCharts() {
            // Best Timing
            const timingCounts = countValues('best_timing');
            const sortedTiming = Object.entries(timingCounts)
                .sort((a, b) => b[1] - a[1]);
            
            createChart('chart-best-timing', 'bar', {
                labels: sortedTiming.map(t => t[0]),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª',
                    data: sortedTiming.map(t => t[1]),
                    backgroundColor: '#2ecc71'
                }]
            }, {
                indexAxis: 'y'
            });
            
            // Seasonal Approach
            const seasonalCounts = countValues('seasonal_approach');
            createChart('chart-seasonal-approach', 'doughnut', {
                labels: Object.keys(seasonalCounts),
                datasets: [{
                    data: Object.values(seasonalCounts),
                    backgroundColor: ['#2ecc71', '#3498db', '#f39c12', '#95a5a6']
                }]
            });
            
            // Campaigns Effect
            const effectCounts = countValues('campaigns_effect');
            createChart('chart-campaigns-effect', 'pie', {
                labels: Object.keys(effectCounts),
                datasets: [{
                    data: Object.values(effectCounts),
                    backgroundColor: ['#2ecc71', '#e74c3c', '#95a5a6', '#3498db']
                }]
            });
            
            // Quarterly Distribution
            const q1Values = filteredResponses.map(r => parseInt(r.dist_q1) || 0);
            const q2Values = filteredResponses.map(r => parseInt(r.dist_q2) || 0);
            const q3Values = filteredResponses.map(r => parseInt(r.dist_q3) || 0);
            const q4Values = filteredResponses.map(r => parseInt(r.dist_q4) || 0);
            
            const avgQ1 = q1Values.length > 0 ? (q1Values.reduce((a, b) => a + b, 0) / q1Values.length).toFixed(0) : 0;
            const avgQ2 = q2Values.length > 0 ? (q2Values.reduce((a, b) => a + b, 0) / q2Values.length).toFixed(0) : 0;
            const avgQ3 = q3Values.length > 0 ? (q3Values.reduce((a, b) => a + b, 0) / q3Values.length).toFixed(0) : 0;
            const avgQ4 = q4Values.length > 0 ? (q4Values.reduce((a, b) => a + b, 0) / q4Values.length).toFixed(0) : 0;
            
            createChart('chart-quarterly-distribution', 'bar', {
                labels: ['Q1 (ÙŠÙ†Ø§ÙŠØ±-Ù…Ø§Ø±Ø³)', 'Q2 (Ø£Ø¨Ø±ÙŠÙ„-ÙŠÙˆÙ†ÙŠÙˆ)', 'Q3 (ÙŠÙˆÙ„ÙŠÙˆ-Ø³Ø¨ØªÙ…Ø¨Ø±)', 'Q4 (Ø£ÙƒØªÙˆØ¨Ø±-Ø¯ÙŠØ³Ù…Ø¨Ø±)'],
                datasets: [{
                    label: 'Ù…ØªÙˆØ³Ø· Ø§Ù„ØªØ±ÙƒÙŠØ² Ø§Ù„Ù…Ù‚ØªØ±Ø­ (%)',
                    data: [avgQ1, avgQ2, avgQ3, avgQ4],
                    backgroundColor: ['#3498db', '#2ecc71', '#f39c12', '#e74c3c']
                }]
            }, {
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 100,
                        ticks: {
                            callback: function(value) {
                                return value + '%';
                            }
                        }
                    }
                }
            });
            
            // Quarterly Analysis
            const quarters = [
                { name: 'Q1', value: avgQ1 },
                { name: 'Q2', value: avgQ2 },
                { name: 'Q3', value: avgQ3 },
                { name: 'Q4', value: avgQ4 }
            ];
            const maxQuarter = quarters.reduce((max, q) => q.value > max.value ? q : max);
            
            document.getElementById('quarterly-analysis').innerHTML = `
                Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø£Ø¹Ù„Ù‰ ØªØ±ÙƒÙŠØ²Ø§Ù‹ Ù…Ù‚ØªØ±Ø­Ø§Ù‹: <strong>${maxQuarter.name}</strong> Ø¨Ù†Ø³Ø¨Ø© <strong>${maxQuarter.value}%</strong><br>
                Ø§Ù„ØªÙˆØ²ÙŠØ¹: Q1 (${avgQ1}%) | Q2 (${avgQ2}%) | Q3 (${avgQ3}%) | Q4 (${avgQ4}%)
            `;
        }
        
        // ============================================
        // Readiness Charts
        // ============================================
        function createReadinessCharts() {
            // Personal vs Team Readiness Comparison
            const personalRatings = filteredResponses
                .map(r => parseInt(r.personal_readiness))
                .filter(r => !isNaN(r));
            
            const teamRatings = filteredResponses
                .map(r => parseInt(r.team_readiness))
                .filter(r => !isNaN(r));
            
            const avgPersonal = personalRatings.length > 0 ? 
                (personalRatings.reduce((a, b) => a + b, 0) / personalRatings.length).toFixed(1) : 0;
            
            const avgTeam = teamRatings.length > 0 ? 
                (teamRatings.reduce((a, b) => a + b, 0) / teamRatings.length).toFixed(1) : 0;
            
            createChart('chart-readiness-comparison', 'bar', {
                labels: ['Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„Ø´Ø®ØµÙŠØ©', 'Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„ÙØ±ÙŠÙ‚'],
                datasets: [{
                    label: 'Ù…ØªÙˆØ³Ø· Ø§Ù„ØªÙ‚ÙŠÙŠÙ… (1-10)',
                    data: [avgPersonal, avgTeam],
                    backgroundColor: ['#2ecc71', '#3498db']
                }]
            }, {
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 10
                    }
                }
            });
            
            // Readiness Gap Analysis
            const gap = (avgPersonal - avgTeam).toFixed(1);
            document.getElementById('readiness-gap-analysis').innerHTML = `
                Ù…ØªÙˆØ³Ø· Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„Ø´Ø®ØµÙŠØ©: <strong>${avgPersonal}/10</strong><br>
                Ù…ØªÙˆØ³Ø· Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„ÙØ±ÙŠÙ‚: <strong>${avgTeam}/10</strong><br>
                Ø§Ù„ÙØ¬ÙˆØ©: <strong>${Math.abs(gap)}</strong> Ù†Ù‚Ø·Ø© ${gap > 0 ? '(Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„Ø´Ø®ØµÙŠØ© Ø£Ø¹Ù„Ù‰)' : '(Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„ÙØ±ÙŠÙ‚ Ø£Ø¹Ù„Ù‰)'}
            `;
            
            // Personal Readiness Distribution
            const personalCounts = {};
            for (let i = 1; i <= 10; i++) {
                personalCounts[i] = personalRatings.filter(r => r === i).length;
            }
            
            createChart('chart-personal-readiness', 'bar', {
                labels: Object.keys(personalCounts),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†',
                    data: Object.values(personalCounts),
                    backgroundColor: '#2ecc71'
                }]
            });
            
            // Team Readiness Distribution
            const teamCounts = {};
            for (let i = 1; i <= 10; i++) {
                teamCounts[i] = teamRatings.filter(r => r === i).length;
            }
            
            createChart('chart-team-readiness', 'bar', {
                labels: Object.keys(teamCounts),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†',
                    data: Object.values(teamCounts),
                    backgroundColor: '#3498db'
                }]
            });
            
            // Target Possible
            const possibleCounts = countValues('target_possible');
            createChart('chart-target-possible', 'bar', {
                labels: Object.keys(possibleCounts),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†',
                    data: Object.values(possibleCounts),
                    backgroundColor: '#f39c12'
                }]
            }, {
                indexAxis: 'y'
            });
            
            // Success Requirements
            const reqCounts = countValues('success_requirements');
            const sortedReq = Object.entries(reqCounts)
                .sort((a, b) => b[1] - a[1]);
            
            createChart('chart-success-requirements', 'bar', {
                labels: sortedReq.map(r => r[0]),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª',
                    data: sortedReq.map(r => r[1]),
                    backgroundColor: '#2ecc71'
                }]
            }, {
                indexAxis: 'y'
            });
        }
        
        // ============================================
        // Donor Perspective Charts
        // ============================================
        function createDonorPerspectiveCharts() {
            // Reasons to Donate
            const donateCounts = countValues('reasons_to_donate');
            const sortedDonate = Object.entries(donateCounts)
                .sort((a, b) => b[1] - a[1]);
            
            createChart('chart-reasons-donate', 'bar', {
                labels: sortedDonate.map(d => d[0]),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª',
                    data: sortedDonate.map(d => d[1]),
                    backgroundColor: '#2ecc71'
                }]
            }, {
                indexAxis: 'y'
            });
            
            // Reasons to Repeat
            const repeatCounts = countValues('reasons_to_repeat');
            const sortedRepeat = Object.entries(repeatCounts)
                .sort((a, b) => b[1] - a[1]);
            
            createChart('chart-reasons-repeat', 'bar', {
                labels: sortedRepeat.map(r => r[0]),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª',
                    data: sortedRepeat.map(r => r[1]),
                    backgroundColor: '#3498db'
                }]
            }, {
                indexAxis: 'y'
            });
            
            // Reasons to Refer
            const referCounts = countValues('reasons_to_refer');
            const sortedRefer = Object.entries(referCounts)
                .sort((a, b) => b[1] - a[1]);
            
            createChart('chart-reasons-refer', 'bar', {
                labels: sortedRefer.map(r => r[0]),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª',
                    data: sortedRefer.map(r => r[1]),
                    backgroundColor: '#f39c12'
                }]
            }, {
                indexAxis: 'y'
            });
            
            // Reasons to Stop
            const stopCounts = countValues('reasons_to_stop');
            const sortedStop = Object.entries(stopCounts)
                .sort((a, b) => b[1] - a[1]);
            
            createChart('chart-reasons-stop', 'bar', {
                labels: sortedStop.map(s => s[0]),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª',
                    data: sortedStop.map(s => s[1]),
                    backgroundColor: '#e74c3c'
                }]
            }, {
                indexAxis: 'y'
            });
        }
        
        // ============================================
        // Suggestions Charts
        // ============================================
        function createSuggestionsCharts() {
            // Competitive Edge
            const edgeCounts = countValues('competitive_edge');
            const sortedEdge = Object.entries(edgeCounts)
                .sort((a, b) => b[1] - a[1]);
            
            createChart('chart-competitive-edge', 'bar', {
                labels: sortedEdge.map(e => e[0]),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª',
                    data: sortedEdge.map(e => e[1]),
                    backgroundColor: '#f39c12'
                }]
            }, {
                indexAxis: 'y'
            });
        }
        
        // ============================================
        // Populate Text Lists
        // ============================================
        function populateTextLists() {
            // Hardest Questions
            populateList('hardest-questions-list', 'hardest_question');
            
            // Period Reasons
            const periodReasons = filteredResponses
                .filter(r => r.strong_period_reason || r.weak_period_reason)
                .map(r => {
                    let html = '';
                    if (r.strong_period_reason) {
                        html += `<strong>Ù‚ÙˆÙŠ (${r.strong_period}):</strong> ${r.strong_period_reason}<br>`;
                    }
                    if (r.weak_period_reason) {
                        html += `<strong>Ø¶Ø¹ÙŠÙ (${r.weak_period}):</strong> ${r.weak_period_reason}`;
                    }
                    return html;
                });
            
            const periodContainer = document.getElementById('period-reasons-text');
            if (periodReasons.length > 0) {
                periodContainer.innerHTML = periodReasons.map((r, i) => 
                    `<div style="padding: 15px; margin-bottom: 10px; background: white; border-radius: 8px; border-right: 3px solid #3498db;">
                        <strong>#${i + 1}</strong><br>${r}
                    </div>`
                ).join('');
            } else {
                periodContainer.innerHTML = '<p style="color: #999;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¬Ø§Ø¨Ø§Øª</p>';
            }
            
            // Situations 2025
            populateList('situations-2025-list', 'situation_2025');
            
            // Would Change
            populateList('would-change-list', 'would_change');
            
            // Competitor Names
            const compNames = filteredResponses
                .map(r => r.competitor_names)
                .filter(c => c && c.trim())
                .join(', ');
            
            document.getElementById('competitor-names-list').innerHTML = compNames || 
                '<p style="color: #999;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø³Ù…Ø§Ø¡ Ù…Ø­Ø¯Ø¯Ø©</p>';
            
            // Common Objections
            populateList('common-objections-list', 'common_objection');
            
            // Should Stop
            populateList('should-stop-list', 'should_stop');
            
            // Should Start
            populateList('should-start-list', 'should_start');
            
            // Magic Fixes (3 fields)
            const magicFixes = filteredResponses
                .filter(r => r.magic_fix_1 || r.magic_fix_2 || r.magic_fix_3)
                .map(r => {
                    return `
                        <div style="padding: 20px; margin-bottom: 15px; background: white; border-radius: 10px; border: 2px solid #f39c12;">
                            ${r.magic_fix_1 ? `<div style="margin-bottom: 10px;"><strong>1ï¸âƒ£ Ø§Ù„Ø£ÙˆÙ„ (Ø§Ù„Ø£Ù‡Ù…):</strong><br>${r.magic_fix_1}</div>` : ''}
                            ${r.magic_fix_2 ? `<div style="margin-bottom: 10px;"><strong>2ï¸âƒ£ Ø§Ù„Ø«Ø§Ù†ÙŠ:</strong><br>${r.magic_fix_2}</div>` : ''}
                            ${r.magic_fix_3 ? `<div><strong>3ï¸âƒ£ Ø§Ù„Ø«Ø§Ù„Ø«:</strong><br>${r.magic_fix_3}</div>` : ''}
                        </div>
                    `;
                });
            
            document.getElementById('magic-fixes-list').innerHTML = magicFixes.length > 0 ? 
                magicFixes.join('') : '<p style="color: white;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¬Ø§Ø¨Ø§Øª</p>';
            
            // Creative Ideas
            populateList('creative-ideas-list', 'creative_idea', 'white');
            
            // Final Messages
            populateList('final-messages-list', 'final_message', 'white');
        }
        
        function populateList(containerId, fieldName, textColor = '#666') {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            const items = filteredResponses
                .map(r => r[fieldName])
                .filter(item => item && item.trim());
            
            if (items.length > 0) {
                container.innerHTML = items.map((item, i) => 
                    `<div style="padding: 15px; margin-bottom: 10px; background: ${textColor === 'white' ? 'rgba(255,255,255,0.2)' : 'white'}; border-radius: 8px; border-right: 3px solid ${textColor === 'white' ? 'white' : '#2ecc71'}; color: ${textColor};">
                        <strong>#${i + 1}</strong><br>${item}
                    </div>`
                ).join('');
            } else {
                container.innerHTML = `<p style="color: ${textColor === 'white' ? 'rgba(255,255,255,0.7)' : '#999'};">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¬Ø§Ø¨Ø§Øª</p>`;
            }
        }

        // ============================================
        // Populate Raw Data Table
        // ============================================
        function populateRawDataTable() {
            const tbody = document.getElementById('raw-data-tbody');
            if (!tbody) return;
            
            if (filteredResponses.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="9" style="padding: 40px; text-align: center; color: var(--gray);">
                            Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª
                        </td>
                    </tr>
                `;
                return;
            }

            // Sort by date - newest first
            const sortedResponses = [...filteredResponses].sort((a, b) => {
                const dateA = a.timestamp ? new Date(a.timestamp) : new Date(0);
                const dateB = b.timestamp ? new Date(b.timestamp) : new Date(0);
                return dateB - dateA; // Newest first
            });
            
            tbody.innerHTML = sortedResponses.map((response, index) => {
                const date = response.timestamp ? new Date(response.timestamp).toLocaleDateString('ar-EG') : '-';
                
                return `
                    <tr style="border-bottom: 1px solid #e0e0e0;">
                        <td style="padding: 12px; border: 1px solid #ddd;">${index + 1}</td>
                        <td style="padding: 12px; border: 1px solid #ddd; white-space: nowrap;">${date}</td>
                        <td style="padding: 12px; border: 1px solid #ddd;">${response.department || '-'}</td>
                        <td style="padding: 12px; border: 1px solid #ddd;">${response.experience || '-'}</td>
                        <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${response.palm_knowledge || '-'}</td>
                        <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${response.personal_readiness || '-'}</td>
                        <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">${response.team_readiness || '-'}</td>
                        <td style="padding: 12px; border: 1px solid #ddd;">${response.target_possible || '-'}</td>
                        <td style="padding: 12px; border: 1px solid #ddd; white-space: nowrap;">
                            <button onclick="viewFullResponse('${response.id}')" style="padding: 6px 12px; background: #3498db; color: white; border: none; border-radius: 5px; cursor: pointer; margin-left: 5px;">
                                ğŸ‘ï¸ Ø¹Ø±Ø¶
                            </button>
                            <button onclick="deleteResponse('${response.id}')" style="padding: 6px 12px; background: #e74c3c; color: white; border: none; border-radius: 5px; cursor: pointer;">
                                ğŸ—‘ï¸ Ø­Ø°Ù
                            </button>
                        </td>
                    </tr>
                `;
            }).join('');
        }
        
        // ============================================
        // View Full Response
        // ============================================
        // ============================================
        // View Full Response - ENHANCED VERSION
        // ============================================
        function viewFullResponse(responseId) {
            const response = allResponses.find(r => r.id === responseId);
            if (!response) return;
            
            // Create modal overlay
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0,0,0,0.85);
                z-index: 10000;
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 20px;
                animation: fadeIn 0.3s ease-out;
            `;
            
            // Create modal content
            const content = document.createElement('div');
            content.style.cssText = `
                background: white;
                border-radius: 20px;
                padding: 0;
                max-width: 1000px;
                width: 100%;
                max-height: 85vh;
                overflow: hidden;
                direction: rtl;
                box-shadow: 0 25px 50px rgba(0,0,0,0.5);
                animation: slideUp 0.3s ease-out;
            `;
            
            // Format date
            const date = response.timestamp ? 
                new Date(response.timestamp).toLocaleString('ar-EG', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                }) : 'ØºÙŠØ± Ù…ØªÙˆÙØ±';
            
            // Build organized sections
            const sections = buildResponseSections(response);
            
            content.innerHTML = `
                <!-- Header -->
                <div style="background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%); color: white; padding: 25px 30px; display: flex; justify-content: space-between; align-items: center; border-bottom: 3px solid #27ae60;">
                    <div>
                        <h2 style="margin: 0 0 8px 0; font-size: 24px; font-weight: 700;">ğŸ“‹ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©</h2>
                        <p style="margin: 0; font-size: 14px; opacity: 0.95;">ğŸ• ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: ${date}</p>
                    </div>
                    <button onclick="this.closest('[style*=fixed]').remove()" style="padding: 10px 20px; background: rgba(255,255,255,0.2); color: white; border: 2px solid white; border-radius: 10px; cursor: pointer; font-size: 16px; font-weight: 600; transition: all 0.3s;" onmouseover="this.style.background='white'; this.style.color='#2ecc71'" onmouseout="this.style.background='rgba(255,255,255,0.2)'; this.style.color='white'">
                        âœ– Ø¥ØºÙ„Ø§Ù‚
                    </button>
                </div>
                
                <!-- Content -->
                <div style="padding: 30px; overflow-y: auto; max-height: calc(85vh - 100px);">
                    ${sections}
                </div>
                
                <!-- Footer -->
                <div style="background: #f8f9fa; padding: 20px 30px; border-top: 2px solid #e0e0e0; display: flex; justify-content: space-between; align-items: center;">
                    <div style="font-size: 13px; color: #666;">
                        ğŸ†” Ù…Ø¹Ø±Ù Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©: <code style="background: #e0e0e0; padding: 3px 8px; border-radius: 5px; font-family: monospace;">${response.id}</code>
                    </div>
                    <button onclick="exportSingleResponse('${response.id}')" style="padding: 10px 20px; background: #3498db; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">
                        ğŸ“¥ ØªØµØ¯ÙŠØ± Ù‡Ø°Ù‡ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©
                    </button>
                </div>
            `;
            
            modal.appendChild(content);
            document.body.appendChild(modal);
            
            // Close on outside click
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }
        
        // ============================================
        // Build Response Sections
        // ============================================
        function buildResponseSections(response) {
            let html = '';
            
            // Section 1: Ø§Ù„Ù‡ÙˆÙŠØ© ÙˆØ§Ù„Ø®Ù„ÙÙŠØ©
            html += createSection('ğŸ‘¤ Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø£ÙˆÙ„: Ù…Ù† Ø£Ù†Øª ÙÙŠ Ø§Ù„Ù…Ù†Ø¸ÙˆÙ…Ø©ØŸ', '#2ecc71', [
                { label: 'Ø§Ù„Ù‚Ø³Ù…/Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©', value: response.department },
                { label: 'Ø³Ù†ÙˆØ§Øª Ø§Ù„Ø®Ø¨Ø±Ø©', value: response.experience },
                { label: 'Ù‡Ù„ Ø¹Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø®ÙŠÙ„ 2025', value: response.worked_on_palm },
                { label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø§Ù„ØªÙŠ ÙŠØ¹Ù…Ù„ Ø¹Ù„ÙŠÙ‡Ø§', value: response.items_count },
                { label: 'Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ø¹Ø±ÙØ© Ø¨Ø¨Ù†Ø¯ Ø§Ù„Ù†Ø®ÙŠÙ„ (1-10)', value: response.palm_knowledge, highlight: true }
            ]);
            
            // Section 2: Ø§Ù„ÙÙ‡Ù… ÙˆØ§Ù„Ù…Ø¹Ø±ÙØ©
            html += createSection('ğŸ“– Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø«Ø§Ù†ÙŠ: Ø§Ù„ÙÙ‡Ù… ÙˆØ§Ù„Ù…Ø¹Ø±ÙØ©', '#3498db', [
                { label: 'Ù…Ø³ØªÙˆÙ‰ ÙÙ‡Ù… Ù‚ØµØ© Ø§Ù„Ø¨Ù†Ø¯', value: response.understanding_level },
                { label: 'ÙƒÙØ§ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©', value: response.info_sufficient },
                { label: 'Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø§Ù‚ØµØ©', value: response.missing_info, type: 'array' },
                { label: 'ØµØ¹ÙˆØ¨Ø© Ø§Ù„Ø´Ø±Ø­ Ù„Ù„Ù…ØªØ¨Ø±Ø¹ÙŠÙ†', value: response.explanation_difficulty },
                { label: 'Ø£ØµØ¹Ø¨ Ø³Ø¤Ø§Ù„ Ù…Ù† Ø§Ù„Ù…ØªØ¨Ø±Ø¹ÙŠÙ†', value: response.hardest_question, type: 'text' },
                { label: 'Ù…Ø§ ÙŠØ¬Ø¹Ù„ Ø§Ù„Ù†Ø®ÙŠÙ„ Ø£ØµØ¹Ø¨', value: response.palm_difficulty, type: 'array' },
                { label: 'Ø£Ø³Ù‡Ù„ Ø¨Ù†Ø¯ ÙÙŠ Ø§Ù„ØªØ³ÙˆÙŠÙ‚', value: response.easiest_item }
            ]);
            
            // Section 3: ØªØ­Ù„ÙŠÙ„ Ø£Ø¯Ø§Ø¡ 2025
            html += createSection('ğŸ” Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø«Ø§Ù„Ø«: ØªØ­Ù„ÙŠÙ„ Ø£Ø¯Ø§Ø¡ 2025', '#f39c12', [
                { label: 'Ù…Ø¹Ø±ÙØ© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù Ø§Ù„Ù…Ø§Ù„ÙŠ', value: response.know_target },
                { label: 'Ø£Ø³Ø¨Ø§Ø¨ Ø¹Ø¯Ù… ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù', value: response.failure_reasons, type: 'array' },
                { label: 'Ø£Ù‚ÙˆÙ‰ ÙØªØ±Ø© ÙÙŠ 2025', value: response.strong_period },
                { label: 'Ø³Ø¨Ø¨ Ù‚ÙˆØ© Ø§Ù„ÙØªØ±Ø©', value: response.strong_period_reason, type: 'text' },
                { label: 'Ø£Ø¶Ø¹Ù ÙØªØ±Ø© ÙÙŠ 2025', value: response.weak_period },
                { label: 'Ø³Ø¨Ø¨ Ø¶Ø¹Ù Ø§Ù„ÙØªØ±Ø©', value: response.weak_period_reason, type: 'text' },
                { label: 'ØªØ£Ø«ÙŠØ± ØªÙ‚Ù„ÙŠØµ Ø§Ù„ØªÙˆØ«ÙŠÙ‚', value: response.documentation_impact },
                { label: 'ØªØ£Ø«ÙŠØ± Ø³Ø­Ø¨ Ø§Ù„Ø¹Ù…Ø±Ø©', value: response.umrah_draw_impact },
                { label: 'Ø£ØµØ¹Ø¨ Ù…Ø±Ø­Ù„Ø©', value: response.hardest_stage },
                { label: 'Ù…ÙˆÙ‚Ù ÙŠÙˆØ¶Ø­ Ø¶Ø¹Ù 2025', value: response.situation_2025, type: 'text' },
                { label: 'Ù…Ø§ Ø³ÙŠØªØºÙŠØ± Ù„Ùˆ Ø±Ø¬Ø¹ Ø§Ù„Ø²Ù…Ù†', value: response.would_change, type: 'text' }
            ]);
            
            // Section 4: Ø§Ù„Ù…Ù†Ø§ÙØ³Ø©
            html += createSection('ğŸ† Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø±Ø§Ø¨Ø¹: Ø§Ù„Ù…Ù†Ø§ÙØ³Ø©', '#9b59b6', [
                { label: 'Ù…Ø¹Ø±ÙØ© Ø§Ù„Ù…Ù†Ø§ÙØ³ÙŠÙ†', value: response.know_competitors },
                { label: 'Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…Ù†Ø§ÙØ³ÙŠÙ†', value: response.competitor_names, type: 'text' },
                { label: 'Ù…Ù…ÙŠØ²Ø§ØªÙ†Ø§ Ø¹Ù† Ø§Ù„Ù…Ù†Ø§ÙØ³ÙŠÙ†', value: response.our_advantages, type: 'array' },
                { label: 'Ø§Ø¹ØªØ±Ø§Ø¶Ø§Øª Ø¨Ø³Ø¨Ø¨ Ø§Ù„Ù…Ù†Ø§ÙØ³ÙŠÙ†', value: response.competitor_objection },
                { label: 'Ø§Ù„Ø§Ø¹ØªØ±Ø§Ø¶ Ø§Ù„Ø´Ø§Ø¦Ø¹', value: response.common_objection, type: 'text' },
                { label: 'Ø§Ù„Ù…Ù†Ø§ÙØ³Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©', value: response.internal_competition, type: 'array' },
                { label: 'ØªØ¶Ø§Ø±Ø¨ Ø§Ù„Ø¨Ù†ÙˆØ¯', value: response.items_conflict },
                { label: 'Ø­Ù„ Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø§Ù„Ù…ØªØ¹Ø¯Ø¯Ø©', value: response.multi_item_solution }
            ]);
            
            // Section 5: Ø§Ù„ØªØ³ÙˆÙŠÙ‚ ÙˆØ§Ù„Ù…Ø­ØªÙˆÙ‰
            html += createSection('ğŸ“¢ Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø®Ø§Ù…Ø³: Ø§Ù„ØªØ³ÙˆÙŠÙ‚ ÙˆØ§Ù„Ù…Ø­ØªÙˆÙ‰', '#e74c3c', [
                { label: 'Ø¬ÙˆØ¯Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ³ÙˆÙŠÙ‚ÙŠ (1-10)', value: response.content_quality, highlight: true },
                { label: 'Ø£ÙƒØ«Ø± Ù…Ø­ØªÙˆÙ‰ ÙØ¹Ù‘Ø§Ù„', value: response.most_effective_content },
                { label: 'ÙˆØ¶ÙˆØ­ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„', value: response.messages_clarity },
                { label: 'Ø£ÙØ¶Ù„ Ø±Ø³Ø§Ù„Ø© ØªØ³ÙˆÙŠÙ‚ÙŠØ©', value: response.best_message },
                { label: 'Ø§Ù„Ø§Ø¹ØªØ±Ø§Ø¶ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ', value: response.main_objection },
                { label: 'Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª', value: response.ready_answers },
                { label: 'Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ÙŠØ© Ø§Ù„Ù…ÙØ¶Ù„Ø©', value: response.ad_channels, type: 'array' }
            ]);
            
            // Section 6: Ø§Ù„ØªÙ†Ø³ÙŠÙ‚
            html += createSection('ğŸ¤ Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø³Ø§Ø¯Ø³: Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ù…Ø¹ Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬', '#1abc9c', [
                { label: 'Ø¬ÙˆØ¯Ø© Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ (1-10)', value: response.coordination_quality, highlight: true },
                { label: 'Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚', value: response.coordination_problems, type: 'array' },
                { label: 'ÙˆØ¬ÙˆØ¯ SLA', value: response.sla_existence },
                { label: 'Ø­Ù„ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„', value: response.problem_resolution },
                { label: 'Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª Ù…Ù† Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬', value: response.needs_from_programs, type: 'array' }
            ]);
            
            // Section 7: Ø§Ù„Ù…ÙˆØ³Ù…ÙŠØ© ÙˆØ§Ù„ØªÙˆÙ‚ÙŠØª
            html += createSection('â° Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø³Ø§Ø¨Ø¹: Ø§Ù„Ù…ÙˆØ³Ù…ÙŠØ© ÙˆØ§Ù„ØªÙˆÙ‚ÙŠØª', '#34495e', [
                { label: 'Ø£ÙØ¶Ù„ ØªÙˆÙ‚ÙŠØª Ù„Ù„Ù†Ø®ÙŠÙ„', value: response.best_timing, type: 'array' },
                { label: 'Ù†Ù‡Ø¬ Ù…ÙˆØ³Ù…ÙŠ Ø£Ù… Ù…Ø³ØªÙ…Ø±', value: response.seasonal_approach },
                { label: 'ØªØ£Ø«ÙŠØ± Ø§Ù„Ø­Ù…Ù„Ø§Øª Ø§Ù„Ù…ÙˆØ³Ù…ÙŠØ©', value: response.campaigns_effect },
                { label: 'ØªÙˆØ²ÙŠØ¹ Q1 (%)', value: response.dist_q1 },
                { label: 'ØªÙˆØ²ÙŠØ¹ Q2 (%)', value: response.dist_q2 },
                { label: 'ØªÙˆØ²ÙŠØ¹ Q3 (%)', value: response.dist_q3 },
                { label: 'ØªÙˆØ²ÙŠØ¹ Q4 (%)', value: response.dist_q4 }
            ]);
            
            // Section 8: Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ©
            html += createSection('ğŸ’ª Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø«Ø§Ù…Ù†: Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ© Ù„Ù€60 Ù…Ù„ÙŠÙˆÙ†', '#27ae60', [
                { label: 'Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„Ø´Ø®ØµÙŠØ© (1-10)', value: response.personal_readiness, highlight: true },
                { label: 'Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„ÙØ±ÙŠÙ‚ (1-10)', value: response.team_readiness, highlight: true },
                { label: 'Ù‡Ù„ Ø§Ù„Ù‡Ø¯Ù Ù…Ù…ÙƒÙ†ØŸ', value: response.target_possible },
                { label: 'Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ù†Ø¬Ø§Ø­', value: response.success_requirements, type: 'array' },
                { label: 'Ù…Ø§ ÙŠØ¬Ø¨ Ø§Ù„ØªÙˆÙ‚Ù Ø¹Ù†Ù‡', value: response.should_stop, type: 'text' },
                { label: 'Ù…Ø§ ÙŠØ¬Ø¨ Ø§Ù„Ø¨Ø¯Ø¡ ÙÙŠÙ‡', value: response.should_start, type: 'text' }
            ]);
            
            // Section 9: Ù„Ùˆ ÙƒÙ†Øª Ø§Ù„Ù…ØªØ¨Ø±Ø¹
            html += createSection('ğŸ¯ Ø§Ù„Ù‚Ø³Ù… Ø§Ù„ØªØ§Ø³Ø¹: Ù„Ùˆ ÙƒÙ†Øª Ø£Ù†Øª Ø§Ù„Ù…ØªØ¨Ø±Ø¹', '#2980b9', [
                { label: 'Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„ØªØ¨Ø±Ø¹ Ù„Ø£ÙˆÙ„ Ù…Ø±Ø©', value: response.reasons_to_donate, type: 'array' },
                { label: 'Ø£Ø³Ø¨Ø§Ø¨ ØªÙƒØ±Ø§Ø± Ø§Ù„ØªØ¨Ø±Ø¹', value: response.reasons_to_repeat, type: 'array' },
                { label: 'Ø£Ø³Ø¨Ø§Ø¨ ØªØ±Ø´ÙŠØ­ Ø§Ù„ØºÙŠØ±', value: response.reasons_to_refer, type: 'array' },
                { label: 'Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„ØªÙˆÙ‚Ù Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹', value: response.reasons_to_stop, type: 'array' }
            ]);
            
            // Section 10: Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø§Øª
            html += createSection('ğŸ’¡ Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø¹Ø§Ø´Ø±: Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø§Øª ÙˆØ§Ù„Ø­Ù„ÙˆÙ„', '#d35400', [
                { label: 'Ø§Ù„Ø¹ØµØ§ Ø§Ù„Ø³Ø­Ø±ÙŠØ© - Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø£ÙˆÙ„ (Ø§Ù„Ø£Ù‡Ù…)', value: response.magic_fix_1, type: 'text', important: true },
                { label: 'Ø§Ù„Ø¹ØµØ§ Ø§Ù„Ø³Ø­Ø±ÙŠØ© - Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø«Ø§Ù†ÙŠ', value: response.magic_fix_2, type: 'text', important: true },
                { label: 'Ø§Ù„Ø¹ØµØ§ Ø§Ù„Ø³Ø­Ø±ÙŠØ© - Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø«Ø§Ù„Ø«', value: response.magic_fix_3, type: 'text', important: true },
                { label: 'Ø§Ù„ÙÙƒØ±Ø© Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ÙŠØ©', value: response.creative_idea, type: 'text' },
                { label: 'Ø§Ù„Ù…ÙŠØ²Ø© Ø§Ù„ØªÙ†Ø§ÙØ³ÙŠØ© Ø§Ù„Ø£Ù‚ÙˆÙ‰', value: response.competitive_edge },
                { label: 'Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© Ù„Ù„ÙˆØ±Ø´Ø©', value: response.final_message, type: 'text', important: true }
            ]);
            
            return html;
        }
        
        // ============================================
        // Create Section Helper
        // ============================================
        function createSection(title, color, fields) {
            let html = `
                <div style="margin-bottom: 30px; border-radius: 15px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.08);">
                    <div style="background: ${color}; color: white; padding: 15px 20px; font-weight: 700; font-size: 18px;">
                        ${title}
                    </div>
                    <div style="background: white; padding: 20px;">
            `;
            
            fields.forEach((field, index) => {
                if (!field.value || field.value === '-' || field.value === '') return;
                
                let valueHtml = '';
                
                if (field.type === 'array') {
                    // Array values
                    const arr = Array.isArray(field.value) ? field.value : 
                                (typeof field.value === 'string' ? field.value.split('ØŒ ') : []);
                    if (arr.length > 0) {
                        valueHtml = '<ul style="margin: 8px 0 0 0; padding-right: 25px;">' + 
                            arr.map(item => `<li style="margin: 5px 0; color: #444;">${item}</li>`).join('') + 
                            '</ul>';
                    }
                } else if (field.type === 'text') {
                    // Long text
                    valueHtml = `<div style="margin-top: 8px; padding: 15px; background: #f8f9fa; border-radius: 8px; border-right: 3px solid ${color}; color: #333; line-height: 1.8; white-space: pre-wrap;">${field.value}</div>`;
                } else {
                    // Simple value
                    valueHtml = `<span style="color: ${field.highlight ? color : '#444'}; font-weight: ${field.highlight ? '700' : '600'}; font-size: ${field.highlight ? '18px' : '16px'};">${field.value}</span>`;
                }
                
                const bgColor = field.important ? '#fff3cd' : (index % 2 === 0 ? '#ffffff' : '#f8f9fa');
                const borderColor = field.important ? '#ffc107' : 'transparent';
                
                html += `
                    <div style="padding: 15px; margin-bottom: 10px; background: ${bgColor}; border-radius: 8px; border-right: 3px solid ${borderColor};">
                        <div style="font-size: 14px; color: #666; margin-bottom: ${field.type ? '5px' : '8px'}; font-weight: 600;">
                            ${field.important ? 'â­ ' : ''}${field.label}:
                        </div>
                        ${valueHtml}
                    </div>
                `;
            });
            
            html += `
                    </div>
                </div>
            `;
            
            return html;
        }
        
        // ============================================
        // Export Single Response
        // ============================================
        function exportSingleResponse(responseId) {
            const response = allResponses.find(r => r.id === responseId);
            if (!response) return;
            
            alert('ØªØµØ¯ÙŠØ± Ø§Ø³ØªØ¬Ø§Ø¨Ø© ÙˆØ§Ø­Ø¯Ø© - Ù‚Ø±ÙŠØ¨Ø§Ù‹!');
        }
        // ============================================
        // Delete Response
        // ============================================
        async function deleteResponse(responseId) {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©ØŸ')) {
                return;
            }
            
            try {
                await db.collection('palm-trees-survey').doc(responseId).delete();
                alert('ØªÙ… Ø§Ù„Ø­Ø°Ù Ø¨Ù†Ø¬Ø§Ø­');
                loadAllData();
            } catch (error) {
                console.error('Error deleting:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­Ø°Ù');
            }
        }
        
        // ============================================
        // Delete All Responses
        // ============================================
        async function deleteAllResponses() {
            const confirmation = prompt('âš ï¸ ØªØ­Ø°ÙŠØ±: Ø³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª!\n\nØ§ÙƒØªØ¨ "DELETE" Ø¨Ø§Ù„Ø£Ø­Ø±Ù Ø§Ù„ÙƒØ¨ÙŠØ±Ø© Ù„Ù„ØªØ£ÙƒÙŠØ¯:');
            
            if (confirmation !== 'DELETE') {
                alert('ØªÙ… Ø§Ù„Ø¥Ù„ØºØ§Ø¡');
                return;
            }
            
            showLoading(true);
            
            try {
                const snapshot = await db.collection('palm-trees-survey').get();
                const batch = db.batch();
                
                snapshot.docs.forEach(doc => {
                    batch.delete(doc.ref);
                });
                
                await batch.commit();
                
                alert('ØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
                loadAllData();
                
            } catch (error) {
                console.error('Error deleting all:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                showLoading(false);
            }
        }
        
        // ============================================
        // Export to Excel
        // ============================================
        function exportToExcel() {
            if (filteredResponses.length === 0) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ±');
                return;
            }
            
            // Prepare data for Excel
            const excelData = filteredResponses.map((response, index) => {
                const row = {
                    '#': index + 1,
                    'Ø§Ù„ØªØ§Ø±ÙŠØ®': response.timestamp ? new Date(response.timestamp).toLocaleDateString('ar-EG') : '-',
                    'Ø§Ù„Ù‚Ø³Ù…': response.department || '-',
                    'Ø³Ù†ÙˆØ§Øª Ø§Ù„Ø®Ø¨Ø±Ø©': response.experience || '-',
                    'Ø¹Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø®ÙŠÙ„ 2025': response.worked_on_palm || '-',
                    'Ø¹Ø¯Ø¯ Ø§Ù„Ø¨Ù†ÙˆØ¯': response.items_count || '-',
                    'Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ø¹Ø±ÙØ© (1-10)': response.palm_knowledge || '-',
                    'Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ÙÙ‡Ù…': response.understanding_level || '-',
                    'ÙƒÙØ§ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª': response.info_sufficient || '-',
                    'Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø§Ù‚ØµØ©': Array.isArray(response.missing_info) ? response.missing_info.join('ØŒ ') : '-',
                    'ØµØ¹ÙˆØ¨Ø© Ø§Ù„Ø´Ø±Ø­': response.explanation_difficulty || '-',
                    'Ø£ØµØ¹Ø¨ Ø³Ø¤Ø§Ù„': response.hardest_question || '-',
                    'ØµØ¹ÙˆØ¨Ø© Ø§Ù„Ù†Ø®ÙŠÙ„': Array.isArray(response.palm_difficulty) ? response.palm_difficulty.join('ØŒ ') : '-',
                    'Ø£Ø³Ù‡Ù„ Ø¨Ù†Ø¯': response.easiest_item || '-',
                    'Ù…Ø¹Ø±ÙØ© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù': response.know_target || '-',
                    'Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„ÙØ´Ù„': Array.isArray(response.failure_reasons) ? response.failure_reasons.join('ØŒ ') : '-',
                    'Ø£Ù‚ÙˆÙ‰ ÙØªØ±Ø©': response.strong_period || '-',
                    'Ø³Ø¨Ø¨ Ø§Ù„Ù‚ÙˆØ©': response.strong_period_reason || '-',
                    'Ø£Ø¶Ø¹Ù ÙØªØ±Ø©': response.weak_period || '-',
                    'Ø³Ø¨Ø¨ Ø§Ù„Ø¶Ø¹Ù': response.weak_period_reason || '-',
                    'ØªØ£Ø«ÙŠØ± Ø§Ù„ØªÙˆØ«ÙŠÙ‚': response.documentation_impact || '-',
                    'ØªØ£Ø«ÙŠØ± Ø³Ø­Ø¨ Ø§Ù„Ø¹Ù…Ø±Ø©': response.umrah_draw_impact || '-',
                    'Ø£ØµØ¹Ø¨ Ù…Ø±Ø­Ù„Ø©': response.hardest_stage || '-',
                    'Ù…ÙˆÙ‚Ù 2025': response.situation_2025 || '-',
                    'Ù…Ø§ Ø³ÙŠØªØºÙŠØ±': response.would_change || '-',
                    'Ù…Ø¹Ø±ÙØ© Ø§Ù„Ù…Ù†Ø§ÙØ³ÙŠÙ†': response.know_competitors || '-',
                    'Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…Ù†Ø§ÙØ³ÙŠÙ†': response.competitor_names || '-',
                    'Ù…Ù…ÙŠØ²Ø§ØªÙ†Ø§': Array.isArray(response.our_advantages) ? response.our_advantages.join('ØŒ ') : '-',
                    'Ø§Ø¹ØªØ±Ø§Ø¶Ø§Øª Ø§Ù„Ù…Ù†Ø§ÙØ³ÙŠÙ†': response.competitor_objection || '-',
                    'Ø§Ù„Ø§Ø¹ØªØ±Ø§Ø¶ Ø§Ù„Ø´Ø§Ø¦Ø¹': response.common_objection || '-',
                    'Ø§Ù„Ù…Ù†Ø§ÙØ³Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©': Array.isArray(response.internal_competition) ? response.internal_competition.join('ØŒ ') : '-',
                    'ØªØ¶Ø§Ø±Ø¨ Ø§Ù„Ø¨Ù†ÙˆØ¯': response.items_conflict || '-',
                    'Ø­Ù„ Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø§Ù„Ù…ØªØ¹Ø¯Ø¯Ø©': response.multi_item_solution || '-',
                    'Ø¬ÙˆØ¯Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ (1-10)': response.content_quality || '-',
                    'Ø£ÙƒØ«Ø± Ù…Ø­ØªÙˆÙ‰ ÙØ¹Ø§Ù„': response.most_effective_content || '-',
                    'ÙˆØ¶ÙˆØ­ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„': response.messages_clarity || '-',
                    'Ø£ÙØ¶Ù„ Ø±Ø³Ø§Ù„Ø©': response.best_message || '-',
                    'Ø§Ù„Ø§Ø¹ØªØ±Ø§Ø¶ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ': response.main_objection || '-',
                    'Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª': response.ready_answers || '-',
                    'Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ÙŠØ©': Array.isArray(response.ad_channels) ? response.ad_channels.join('ØŒ ') : '-',
                    'Ø¬ÙˆØ¯Ø© Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ (1-10)': response.coordination_quality || '-',
                    'Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚': Array.isArray(response.coordination_problems) ? response.coordination_problems.join('ØŒ ') : '-',
                    'ÙˆØ¬ÙˆØ¯ SLA': response.sla_existence || '-',
                    'Ø­Ù„ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„': response.problem_resolution || '-',
                    'Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª Ù…Ù† Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬': Array.isArray(response.needs_from_programs) ? response.needs_from_programs.join('ØŒ ') : '-',
                    'Ø£ÙØ¶Ù„ ØªÙˆÙ‚ÙŠØª': Array.isArray(response.best_timing) ? response.best_timing.join('ØŒ ') : '-',
                    'Ù†Ù‡Ø¬ Ù…ÙˆØ³Ù…ÙŠ/Ù…Ø³ØªÙ…Ø±': response.seasonal_approach || '-',
                    'ØªØ£Ø«ÙŠØ± Ø§Ù„Ø­Ù…Ù„Ø§Øª': response.campaigns_effect || '-',
                    'ØªÙˆØ²ÙŠØ¹ Q1 (%)': response.dist_q1 || '-',
                    'ØªÙˆØ²ÙŠØ¹ Q2 (%)': response.dist_q2 || '-',
                    'ØªÙˆØ²ÙŠØ¹ Q3 (%)': response.dist_q3 || '-',
                    'ØªÙˆØ²ÙŠØ¹ Q4 (%)': response.dist_q4 || '-',
                    'Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„Ø´Ø®ØµÙŠØ© (1-10)': response.personal_readiness || '-',
                    'Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„ÙØ±ÙŠÙ‚ (1-10)': response.team_readiness || '-',
                    'Ù‡Ù„ Ø§Ù„Ù‡Ø¯Ù Ù…Ù…ÙƒÙ†': response.target_possible || '-',
                    'Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ù†Ø¬Ø§Ø­': Array.isArray(response.success_requirements) ? response.success_requirements.join('ØŒ ') : '-',
                    'Ù…Ø§ ÙŠØ¬Ø¨ Ø§Ù„ØªÙˆÙ‚Ù Ø¹Ù†Ù‡': response.should_stop || '-',
                    'Ù…Ø§ ÙŠØ¬Ø¨ Ø§Ù„Ø¨Ø¯Ø¡ ÙÙŠÙ‡': response.should_start || '-',
                    'Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„ØªØ¨Ø±Ø¹': Array.isArray(response.reasons_to_donate) ? response.reasons_to_donate.join('ØŒ ') : '-',
                    'Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„ØªÙƒØ±Ø§Ø±': Array.isArray(response.reasons_to_repeat) ? response.reasons_to_repeat.join('ØŒ ') : '-',
                    'Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„ØªØ±Ø´ÙŠØ­': Array.isArray(response.reasons_to_refer) ? response.reasons_to_refer.join('ØŒ ') : '-',
                    'Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„ØªÙˆÙ‚Ù': Array.isArray(response.reasons_to_stop) ? response.reasons_to_stop.join('ØŒ ') : '-',
                    'Ø§Ù„Ø¥ØµÙ„Ø§Ø­ 1': response.magic_fix_1 || '-',
                    'Ø§Ù„Ø¥ØµÙ„Ø§Ø­ 2': response.magic_fix_2 || '-',
                    'Ø§Ù„Ø¥ØµÙ„Ø§Ø­ 3': response.magic_fix_3 || '-',
                    'Ø§Ù„ÙÙƒØ±Ø© Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ÙŠØ©': response.creative_idea || '-',
                    'Ø§Ù„Ù…ÙŠØ²Ø© Ø§Ù„ØªÙ†Ø§ÙØ³ÙŠØ©': response.competitive_edge || '-',
                    'Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©': response.final_message || '-'
                };
                
                return row;
            });
            
            // Create workbook
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.json_to_sheet(excelData);
            
            // Set column widths
            const colWidths = Object.keys(excelData[0] || {}).map(() => ({ wch: 20 }));
            ws['!cols'] = colWidths;
            
            XLSX.utils.book_append_sheet(wb, ws, 'Ø§Ø³ØªØ¨ÙŠØ§Ù† Ø¨Ù†Ø¯ Ø§Ù„Ù†Ø®ÙŠÙ„');
            
            // Generate filename with date
            const date = new Date().toLocaleDateString('ar-EG').replace(/\//g, '-');
            const filename = `Palm_Trees_Survey_${date}.xlsx`;
            
            // Download
            XLSX.writeFile(wb, filename);
        }
        
        // ============================================
        // Export Section Data
        // ============================================
        function exportSectionData(sectionName) {
            alert(`ØªØµØ¯ÙŠØ± Ù‚Ø³Ù… ${sectionName} - Ù‚Ø±ÙŠØ¨Ø§Ù‹!`);
        }
        
        // ============================================
        // Export Raw Data
        // ============================================
        function exportRawData() {
            exportToExcel();
        }
        
        // ============================================
        // AI Analysis
        // ============================================
        async function triggerAIAnalysis() {
            if (filteredResponses.length === 0) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„ØªØ­Ù„ÙŠÙ„Ù‡Ø§');
                return;
            }
            
            const btn = document.getElementById('ai-analysis-btn');
            btn.disabled = true;
            btn.textContent = 'â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„...';
            
            document.getElementById('ai-analysis-placeholder').style.display = 'none';
            document.getElementById('ai-analysis-container').style.display = 'block';
            
            // Mock AI Analysis - ÙÙŠ Ø§Ù„ÙˆØ§Ù‚Ø¹ Ø³ØªØªØµÙ„ Ø¨Ù€ Vercel Function
            setTimeout(() => {
                performMockAIAnalysis();
                btn.disabled = false;
                btn.textContent = 'ğŸ§  ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ';
            }, 2000);
        }
        
        function performMockAIAnalysis() {
            // Critical Issues
            const failureReasons = countValues('failure_reasons');
            const topFailures = Object.entries(failureReasons)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 5);
            
            document.getElementById('ai-critical-issues').innerHTML = topFailures.map((f, i) => 
                `${i + 1}. <strong>${f[0]}</strong> - ØªÙ… Ø°ÙƒØ±Ù‡ ${f[1]} Ù…Ø±Ø©<br>`
            ).join('');
            
            // Quick Wins
            const quickWins = [
                'ØªÙ‚Ù„ÙŠØµ Ù…Ø¯Ø© Ø§Ù„ØªÙˆØ«ÙŠÙ‚ Ø£Ø«Ø¨Øª ÙØ¹Ø§Ù„ÙŠØªÙ‡ - Ø§Ø³ØªÙ…Ø±ÙˆØ§ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù†Ù‡Ø¬',
                'ØªØ¯Ø±ÙŠØ¨ Ø§Ù„ÙØ±ÙŠÙ‚ Ø¹Ù„Ù‰ Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„Ø§Ø¹ØªØ±Ø§Ø¶Ø§Øª Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©',
                'ØªÙˆÙÙŠØ± Ù…Ø­ØªÙˆÙ‰ ØªØ³ÙˆÙŠÙ‚ÙŠ Ø¬Ø§Ù‡Ø² (ØµÙˆØ±ØŒ ÙÙŠØ¯ÙŠÙˆÙ‡Ø§ØªØŒ posts)',
                'Ø¥Ù†Ø´Ø§Ø¡ SLA ÙˆØ§Ø¶Ø­Ø© Ø¨ÙŠÙ† Ø§Ù„ØªÙ…ÙˆÙŠÙ„ ÙˆØ§Ù„Ø¨Ø±Ø§Ù…Ø¬',
                'ØªØ­Ø¯ÙŠØ¯ ÙØªØ±Ø§Øª Ø²Ù…Ù†ÙŠØ© ÙˆØ§Ø¶Ø­Ø© Ù„Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø®ÙŠÙ„'
            ];
            
            document.getElementById('ai-quick-wins').innerHTML = quickWins.map((w, i) => 
                `${i + 1}. ${w}<br>`
            ).join('');
            
            // Patterns
            const patterns = [
                'ÙØ¬ÙˆØ© Ø¨ÙŠÙ† Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„Ø´Ø®ØµÙŠØ© ÙˆØ¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„ÙØ±ÙŠÙ‚ - ÙŠØ­ØªØ§Ø¬ Ø¨Ù†Ø§Ø¡ Ø«Ù‚Ø© Ø¬Ù…Ø§Ø¹ÙŠØ©',
                'Ù†Ù‚Øµ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© ÙŠØ¹ÙŠÙ‚ Ø§Ù„Ø£Ø¯Ø§Ø¡ - Ø®Ø§ØµØ© Ù‚ØµØµ Ø§Ù„Ø£Ø«Ø± ÙˆØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù„Ù…ÙˆØ³Ø©',
                'Ø§Ù„Ù…Ù†Ø§ÙØ³Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ© (Ø¨Ù†ÙˆØ¯ Ø£Ø®Ø±Ù‰) Ø£ÙƒØ«Ø± ØªØ£Ø«ÙŠØ±Ø§Ù‹ Ù…Ù† Ø§Ù„Ù…Ù†Ø§ÙØ³Ø© Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©',
                'Ø§Ù„Ø£Ø¯Ø§Ø¡ ÙŠØªØ£Ø«Ø± Ø¨Ø´ÙƒÙ„ ÙƒØ¨ÙŠØ± Ø¨Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ù…Ø¹ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬',
                'Ø§Ù„ÙØ±ÙŠÙ‚ Ù„Ø¯ÙŠÙ‡ Ø£ÙÙƒØ§Ø± Ø¥Ø¨Ø¯Ø§Ø¹ÙŠØ© Ù‚ÙˆÙŠØ© Ù„ÙƒÙ† ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ ØªÙ†ÙÙŠØ°'
            ];
            
            document.getElementById('ai-patterns').innerHTML = patterns.map((p, i) => 
                `${i + 1}. ${p}<br>`
            ).join('');
            
            // Recommendations
            const recommendations = [
                '<strong>ØªÙˆØµÙŠØ© Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© 1:</strong> Ø¨Ù†Ø§Ø¡ Ø®Ø·Ø© ØªØ³ÙˆÙŠÙ‚ Ù…Ø®ØµØµØ© Ù„Ù„Ù†Ø®ÙŠÙ„ Ø¨ÙØªØ±Ø§Øª ØªØ±ÙƒÙŠØ² ÙˆØ§Ø¶Ø­Ø© (Q3 ÙŠØ¨Ø¯Ùˆ Ø§Ù„Ø£Ù‚ÙˆÙ‰)',
                '<strong>ØªÙˆØµÙŠØ© Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© 2:</strong> Ø¥Ù†Ø´Ø§Ø¡ "Ø¨Ù†Ùƒ Ù…Ø­ØªÙˆÙ‰" Ø´Ø§Ù…Ù„: Ù‚ØµØµ Ø£Ø«Ø±ØŒ ÙÙŠØ¯ÙŠÙˆÙ‡Ø§ØªØŒ Ø¥Ø¬Ø§Ø¨Ø§Øª Ø¬Ø§Ù‡Ø²Ø©ØŒ Ø¨ÙŠØ§Ù†Ø§Øª',
                '<strong>ØªÙˆØµÙŠØ© Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© 3:</strong> ØªØ­Ø³ÙŠÙ† Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ù…Ø¹ Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬ Ù…Ù† Ø®Ù„Ø§Ù„ SLA ÙˆØ§Ø¶Ø­Ø© ÙˆÙ†Ù‚Ø·Ø© Ø§ØªØµØ§Ù„ Ù…Ø®ØµØµØ©',
                '<strong>ØªÙˆØµÙŠØ© Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© 4:</strong> Ø¨Ø±Ù†Ø§Ù…Ø¬ ØªØ¯Ø±ÙŠØ¨ÙŠ Ù…ÙƒØ«Ù Ø¹Ù„Ù‰ Ø´Ø±Ø­ Ø§Ù„Ø¨Ù†Ø¯ ÙˆØ§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø¹ØªØ±Ø§Ø¶Ø§Øª',
                '<strong>ØªÙˆØµÙŠØ© Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© 5:</strong> Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø£ÙÙƒØ§Ø± Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ÙŠØ© Ù…Ù† Ø§Ù„ÙØ±ÙŠÙ‚ - ØªØ­ÙˆÙŠÙ„Ù‡Ø§ Ù„Ø®Ø·Ø· ØªÙ†ÙÙŠØ°ÙŠØ©',
                '<strong>ØªÙˆØµÙŠØ© Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© 6:</strong> ÙˆØ¶Ø¹ Ù†Ø¸Ø§Ù… Ø­ÙˆØ§ÙØ² Ù…Ø±ØªØ¨Ø· Ø¨Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù†Ø®ÙŠÙ„ Ù„Ø²ÙŠØ§Ø¯Ø© Ø§Ù„ØªØ­ÙÙŠØ²',
                '<strong>ØªÙˆØµÙŠØ© Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© 7:</strong> Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙŠØ²Ø© Ø§Ù„ØªÙ†Ø§ÙØ³ÙŠØ© Ø§Ù„Ø£Ù‚ÙˆÙ‰ (Ø­Ø³Ø¨ Ø±Ø£ÙŠ Ø§Ù„ÙØ±ÙŠÙ‚) ÙÙŠ ÙƒÙ„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„'
            ];
            
            document.getElementById('ai-recommendations').innerHTML = recommendations.map(r => 
                `${r}<br><br>`
            ).join('');
        }
        
        // ============================================
        // Export AI Analysis
        // ============================================
        function exportAIAnalysis() {
            const container = document.getElementById('ai-analysis-container');
            if (container.style.display === 'none') {
                alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }
            
            alert('ØªØµØ¯ÙŠØ± Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ - Ù‚Ø±ÙŠØ¨Ø§Ù‹!');
        }
        
    </script>
</body>
</html>
